<!DOCTYPE html><html lang=en><head>
  <meta content="text/html; charset=utf-8" http-equiv=Content-Type>
  <title>CSS Regions Module Level 1</title>
  <link href=default.css rel=stylesheet type=text/css>

  <link href=http://www.w3.org/StyleSheets/TR/W3C-WD rel=stylesheet type=text/css>

</head>
<body class=h-entry>
<div class=head>
  <p data-fill-with=logo><a href=http://www.w3.org/>
    <img alt=W3C height=48 src=http://www.w3.org/Icons/w3c_home width=72>
</a>
</p>
  <h1 class="p-name no-ref" id=title>CSS Regions Module Level 1</h1>
  <h2 class="no-num no-toc no-ref heading settled" id=subtitle><span class=content>W3C Working Draft,
    <span class=dt-updated><span class=value-title title=20141009>9 October 2014</span></span></span></h2>
  <div data-fill-with=spec-metadata><dl><dt>This version:<dd><a class=u-url href=http://www.w3.org/TR/2014/WD-css-regions-1-20141009/>http://www.w3.org/TR/2014/WD-css-regions-1-20141009/</a><dt>Latest version:<dd><a href=http://www.w3.org/TR/css-regions-1/>http://www.w3.org/TR/css-regions-1/</a><dt>Editor's Draft:<dd><a href=http://dev.w3.org/csswg/css-regions/>http://dev.w3.org/csswg/css-regions/</a><dt>Previous Versions:<dd><a href=http://www.w3.org/TR/2014/WD-css3-regions-20140218/ rel=previous>http://www.w3.org/TR/2014/WD-css3-regions-20140218/</a><dt>Feedback:<dd><span><a href="mailto:www-style@w3.org?subject=%5Dcss-regions%5D%20feedback">www-style@w3.org</a> with subject line “<kbd>[css-regions] <var>… message topic …</var></kbd>” (<a href=http://lists.w3.org/Archives/Public/www-style/ rel=discussion>archives</a>)</span><dt>Test Suite:<dd><a href=http://test.csswg.org/suites/css-regions-1_dev/nightly-unstable/>http://test.csswg.org/suites/css-regions-1_dev/nightly-unstable/</a><dt>Editors:<dd><div class="p-author h-card vcard"><a class="p-name fn u-email email" href=mailto:ratan@microsoft.com>Rossen Atanassov</a> (<span class="p-org org">Microsoft Corporation</span>)</div><dd><div class="p-author h-card vcard"><a class="p-name fn u-email email" href=mailto:stearns@adobe.com>Alan Stearns</a> (<span class="p-org org">Adobe Systems&amp;#44; Inc.</span>)</div><dt>Former Editors:<dd><div class="p-author h-card vcard"><a class="p-name fn u-email email" href=mailto:vhardy@adobe.com>Vincent Hardy</a> (<span class="p-org org">Adobe Systems&amp;#44; Inc.</span>)</div><dt>Issues list:<dd><span><a href="https://www.w3.org/Bugs/Public/buglist.cgi?query_format=advanced&amp;product=CSS&amp;component=Regions&amp;resolution=---&amp;cmdtype=doit">In Bugzilla</a></span></dl></div>
  <div data-fill-with=warning></div>
  <p class=copyright data-fill-with=copyright><a href=http://www.w3.org/Consortium/Legal/ipr-notice#Copyright>Copyright</a> © 2014 <a href=http://www.w3.org/><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href=http://www.csail.mit.edu/><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href=http://www.ercim.eu/><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href=http://www.keio.ac.jp/>Keio</a>, <a href=http://ev.buaa.edu.cn/>Beihang</a>), All Rights Reserved. W3C <a href=http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer>liability</a>, <a href=http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks>trademark</a> and <a href=http://www.w3.org/Consortium/Legal/copyright-documents>document use</a> rules apply.
</p>
  <hr title="Separator for header">
</div>

<h2 class="no-num no-toc no-ref heading settled" id=abstract><span class=content>Abstract</span></h2>
<div class=p-summary data-fill-with=abstract><p>The CSS Regions module allows content from one or more elements to flow through one or more boxes called CSS Regions, fragmented as defined in <a data-biblio-type=normative data-link-type=biblio href=#biblio-css3-break title=CSS3-BREAK>[CSS3-BREAK]</a>. This module also defines CSSOM to expose both the inputs and outputs of this fragmentation.</p>

<a href=http://www.w3.org/TR/CSS/>CSS</a> is a language for describing the rendering of structured documents 
(such as HTML and XML) 
on screen, on paper, in speech, etc.</div>

<h2 class="no-num no-toc no-ref heading settled" id=status><span class=content>Status of this document</span></h2>
<div data-fill-with=status><p><em>This section describes the status of this document at the time of
   its publication. Other documents may supersede this document. A list of
   current W3C publications and the latest revision of this technical report
   can be found in the <a href=http://www.w3.org/TR/>W3C technical reports
   index at http://www.w3.org/TR/.</a></em>

  <p>Publication as a Working Draft does not imply endorsement by the W3C
   Membership. This is a draft document and may be updated, replaced or
   obsoleted by other documents at any time. It is inappropriate to cite this
   document as other than work in progress.

  <p>The (<a href=http://lists.w3.org/Archives/Public/www-style/>archived</a>) public
   mailing list <a href=mailto:www-style@w3.org>www-style@w3.org</a> (see
   <a href=http://www.w3.org/Mail/Request>instructions</a>) is preferred
   for discussion of this specification. When sending e-mail, please put the
   text “css-regions” in the subject, preferably like this:
   “[css-regions] <em>…summary of comment…</em>”

  <p>This document was produced by the <a href=http://www.w3.org/Style/CSS/members>CSS Working Group</a> (part of
   the <a href=http://www.w3.org/Style/>Style Activity</a>).

  <p>This document was produced by a group operating under the <a href=http://www.w3.org/Consortium/Patent-Policy-20040205/>5 February
   2004 W3C Patent Policy</a>. W3C maintains a <a href=http://www.w3.org/2004/01/pp-impl/32061/status rel=disclosure>public list of any patent disclosures</a> made in
   connection with the deliverables of the group; that page also includes
   instructions for disclosing a patent. An individual who has actual
   knowledge of a patent which the individual believes contains <a href=http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential>Essential
   Claim(s)</a> must disclose the information in accordance with <a href=http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure>section
   6 of the W3C Patent Policy</a>.

<p>This document is governed by the <a id="w3c_process_revision"
href="http://www.w3.org/2014/Process-20140801/">1 August 2014 W3C
Process Document</a>.</p>

</div>
<div data-fill-with=at-risk></div>

<h2 class="no-num no-toc no-ref heading settled" id=contents><span class=content>Table of Contents</span></h2>
<div data-fill-with=table-of-contents><ul class=toc><li><a href=#introduction><span class=secno>1</span> <span class=content>
Introduction</span></a><li><a href=#css-regions-concepts><span class=secno>2</span> <span class=content>
CSS Regions concepts</span></a><ul class=toc><li><a href=#regions><span class=secno>2.1</span> <span class=content>
Regions</span></a><li><a href=#region-chain-section><span class=secno>2.2</span> <span class=content>
Region chain</span></a><li><a href=#named-flow-section><span class=secno>2.3</span> <span class=content>
Named flows</span></a><li><a href=#regions-flow-breaking-rules><span class=secno>2.4</span> <span class=content>
Regions flow breaking rules</span></a></ul><li><a href=#properties><span class=secno>3</span> <span class=content>
Properties</span></a><ul class=toc><li><a href=#the-flow-into-property><span class=secno>3.1</span> <span class=content>
The <span class=property data-link-type=propdesc title=flow-into>flow-into</span> property</span></a><li><a href=#flow-from><span class=secno>3.2</span> <span class=content>
The <span class=property data-link-type=propdesc title=flow-from>flow-from</span> property</span></a><ul class=toc><li><a href=#circular-dependencies><span class=secno>3.2.1</span> <span class=content>
Cycle Detection</span></a><li><a href=#fragmenting-regions><span class=secno>3.2.2</span> <span class=content>
Nested fragmentation contexts</span></a></ul><li><a href=#region-flow-break><span class=secno>3.3</span> <span class=content>
Region flow break properties: <span class=property data-link-type=propdesc title=break-before>break-before</span>, <span class=property data-link-type=propdesc title=break-after>break-after</span>, <span class=property data-link-type=propdesc title=break-inside>break-inside</span></span></a><li><a href=#the-region-fragment-property><span class=secno>3.4</span> <span class=content>
The region-fragment property</span></a></ul><li><a href=#cssom_view_and_css_regions><span class=secno>4</span> <span class=content>
CSSOM</span></a><ul class=toc><li><a href=#the-namedflow-interface><span class=secno>4.1</span> <span class=content>
The NamedFlow interface</span></a><li><a href=#the-region-interface><span class=secno>4.2</span> <span class=content>
The Region interface</span></a><li><a href=#named-flow-events><span class=secno>4.3</span> <span class=content>
Named flow events</span></a><li><a href=#cssomview-and-regions><span class=secno>4.4</span> <span class=content>
Clarifications on pre-existing APIs</span></a><ul class=toc><li><a href=#cssomview-getclientrects-and-getboundingclientrect><span class=secno>4.4.1</span> <span class=content>
<code class=idl>getClientRects()</code> and <code>getBoundingClientRect()</code></span></a><li><a href=#cssomview-offset-attributes><span class=secno>4.4.2</span> <span class=content>
<code class=idl>offsetTop</code>, <code class=idl>offsetLeft</code>,
<code class=idl>offsetWidth</code>, <code class=idl>offsetHeight</code> and <code class=idl>offsetParent</code></span></a></ul></ul><li><a href=#multi-column-regions><span class=secno>5</span> <span class=content>
Multi-column regions</span></a><li><a href=#pseudo_elements><span class=secno>6</span> <span class=content>
Pseudo-elements</span></a><li><a href=#regions-visual-formatting-details><span class=secno>7</span> <span class=content>
Regions visual formatting details</span></a><ul class=toc><li><a href=#processing-model><span class=secno>7.1</span> <span class=content>
Processing model</span></a><li><a href=#regions-flow-content-box><span class=secno>7.2</span> <span class=content>
The Region Flow Content Box (RFCB)</span></a><ul class=toc><li><a href=#rfcb-width-resolution><span class=secno>7.2.1</span> <span class=content>
RFCB <span class=property data-link-type=propdesc title=width>width</span> resolution</span></a></ul><li><a href=#regions-visual-formatting-steps><span class=secno>7.3</span> <span class=content>
Regions visual formatting steps</span></a><ul class=toc><li><a href=#rfcb-flow-fragment-height-resolution><span class=secno>7.3.1</span> <span class=content>
Step 1: RFCB flow fragment height resolution</span></a><ul class=toc><li><a href=#rfcb-flow-fragment-height-resolution-phase-1><span class=secno>7.3.1.1</span> <span class=content>
RFCB flow fragment height resolution, Phase 1</span></a><li><a href=#rfcb-flow-fragment-height-resolution-phase-2><span class=secno>7.3.1.2</span> <span class=content>
RFCB flow fragment height resolution, Phase 2</span></a></ul><li><a href=#regions-boxes-layout><span class=secno>7.3.2</span> <span class=content>
Step 2: region boxes layout</span></a><li><a href=#named-flows-layout><span class=secno>7.3.3</span> <span class=content>
Step 3: named flows layout</span></a></ul><li><a href=#regions-visual-formatting-implementation-note><span class=secno>7.4</span> <span class=content>
Regions visual formatting: implementation note</span></a><li><a href=#regions-visual-formatting-examples><span class=secno>7.5</span> <span class=content>
Regions visual formatting example</span></a><ul class=toc><li><a href=#step1-phase1-example><span class=secno>7.5.1</span> <span class=content>
Step 1 - Phase 1: Laying out RFCBs with used height of zero</span></a><li><a href=#step1-phase2-example><span class=secno>7.5.2</span> <span class=content>
Step 1 - Phase 2: Layout flow to compute the RFCBs' flow fragments heights</span></a><li><a href=#step2-example><span class=secno>7.5.3</span> <span class=content>
Step 2: Layout document and regions without named flows</span></a><li><a href=#step3-example><span class=secno>7.5.4</span> <span class=content>
Step 3: named flows layout</span></a></ul></ul><li><a href=#relation-to-document-events><span class=secno>8</span> <span class=content>
Relation to document events</span></a><li><a href=#relation-to-other-specifications><span class=secno>9</span> <span class=content>
Relation to other specifications</span></a><li><a href=#usecases><span class=secno>10</span> <span class=content>
Use Cases</span></a><li><a href=#changes><span class=secno>11</span> <span class=content>
Changes</span></a><ul class=toc><li><a href=#changes_from_Feb_18_2014><span class=secno>11.1</span> <span class=content>
Changes from <span>February 18<sup>th</sup> 2014</span> version</span></a><li><a href=#changes_from_May_28_2013><span class=secno>11.2</span> <span class=content>
Changes from <span>May 28<sup>th</sup> 2013</span> version</span></a><li><a href=#changes_from_Aug_28_2012><span class=secno>11.3</span> <span class=content>
Changes from <span>August 28<sup>th</sup> 2012</span> version</span></a><li><a href=#changes_from_May_03_2012><span class=secno>11.4</span> <span class=content>
Changes from <span>May 3<sup>rd</sup> 2012</span> version</span></a><li><a href=#older_changes><span class=secno>11.5</span> <span class=content>Older Changes</span></a></ul><li><a href=#acknowledgments><span class=secno></span> <span class=content>
Acknowledgments</span></a><li><a href=#conformance><span class=secno></span> <span class=content>
Conformance</span></a><ul class=toc><li><a href=#conventions><span class=secno></span> <span class=content>
Document conventions</span></a><li><a href=#conformance-classes><span class=secno></span> <span class=content>
Conformance classes</span></a><li><a href=#partial><span class=secno></span> <span class=content>
Partial implementations</span></a><li><a href=#experimental><span class=secno></span> <span class=content>
Experimental implementations</span></a><li><a href=#testing><span class=secno></span> <span class=content>
Non-experimental implementations</span></a></ul><li><a href=#references><span class=secno></span> <span class=content>References</span></a><ul class=toc><li><a href=#normative><span class=secno></span> <span class=content>Normative References</span></a><li><a href=#informative><span class=secno></span> <span class=content>Informative References</span></a></ul><li><a href=#index><span class=secno></span> <span class=content>Index</span></a><li><a href=#property-index><span class=secno></span> <span class=content>Property Index</span></a></ul></div>




<h2 class="heading settled" data-level=1 id=introduction><span class=secno>1. </span><span class=content>
Introduction</span><a class=self-link href=#introduction></a></h2>

<p><em>This section is non-normative.</em></p>

<p>The core concept behind CSS Regions
	is the ability to say, 
	"Display <em>this</em> content (a <span class=css>named flow</span>) 
	over <em>there</em> (a <span class=css>region chain</span>)."
	The simplest example is:</p>

	<div class=example>
		<pre><code>
  #this {
    flow-into: my-flow;
  }
  #there {
    flow-from: my-flow;
  }
</code></pre>
	</div>

<p>These two declarations will take
	the element that matches <code>#this</code>, 
	put it into a flow named "my-flow", 
	and display the contents of "my-flow" 
	in the box from the element that matches <code>#there</code>. 
	This example has a single content source for the <span class=css>named flow</span>, 
	and a single box for the <span class=css>region chain</span>. 
	Named flows can also have multiple sources 
	and use multiple boxes for the <span class=css>region chain</span>.</p>

<p>The <span class=css>named flow</span> mechanism can be used
	in several different ways - 
	some of which are 
	custom overflow handling, 
	aggregating content, 
	linked display boxes, 
	magazine-style layout, 
	and flowing content through areas in a paginated view.</p>

	<div class=example>
		Linked display boxes can be created 
		to display article content above and below 
		other content on a page. 
		Given markup like this:

		<pre><code class=html>
  &lt;article&gt; ...some content... &lt;/article&gt;
  &lt;aside&gt; ad or image content &lt;/aside&gt;
</code></pre>

<p>The &lt;aside&gt; content will be displayed
		below all of the article content. 
		On a large screen the page might display without scrolling, 
		but on a small screen the &lt;aside&gt; content 
		might not be visible until the view scrolls. 
		If it’s important to show at least some 
		of the &lt;aside&gt; content in the initial view, 
		CSS Regions can fragment the article content across two boxes - 
		one above the &lt;aside&gt; and one below.</p>

<p>In this example (for simplicity’s sake)
		we create the boxes with additional elements:</p>

		<pre><code class=html>
  &lt;article&gt; ...some content... &lt;/article&gt;
  &lt;div class="top region"&gt;&lt;/div&gt;
  &lt;aside&gt; ad or image content &lt;/aside&gt;
  &lt;div class="region"&gt;&lt;/div&gt;
</code></pre>

		<pre><code>
  article {
    flow-into: article-flow;
  }
  .region {
    flow-from: article-flow;
  }
  .top {
    max-height: 80vh;
  }
</code></pre>

<p>So the top box in the <span class=css>region chain</span>
		is limited to 80% of the viewport height. 
		If the article content doesn’t fit in that box, 
		the article will continue 
		in the second box after the &lt;aside&gt; content.</p>

		<figure style="float:left; margin:1em;">
			<img alt="Article and aside rendering without CSS Regions" src=images/linked-boxes-before.png>
			<figcaption>
				Rendering without CSS Regions
			</figcaption>
		</figure>

		<figure style="float:left; margin:1em;">
			<img alt="Article and aside rendering with CSS Regions" src=images/linked-boxes-after.png>
			<figcaption>
				Rendering with CSS Regions
			</figcaption>
		</figure>

		<p style=clear:left;>In the images above, 
			the gray area represents  
			the content below the screen edge 
			in the initial view.

<p>This example links just two boxes together,
		but more boxes could be added to the <span class=css>region chain</span> 
		to regularly interleave other content with the article.</p>
	</div>

	<div class=example>

<p>Custom overflow handling can be accomplished by linking a separate overflow box. In this example, the overflow box is nestled inside a menu in the markup, and only displays if the menu is toggled.</p>

		<pre><code class=html>
  &lt;nav&gt; ...some links... &lt;/nav&gt;
  &lt;div class="menu"&gt;
    &lt;nav&gt;&lt;/nav&gt;
    ...some more links...
  &lt;/div&gt;
</code></pre>

<p>If the links in the main nav element are placed in a <span class=css>named flow</span>, that flow can be directed through both the main nav element and the overflow nav box in the menu:</p>

		<pre><code>
  nav a {
    flow-into: nav-link-flow;
  }
  nav {
    flow-from: nav-link-flow;
  }
</code></pre>

<p>Then the main nav element and the menu can be arranged with constraints such that when the screen is too narrow for the main nav element to display all of the navigation links, the overflow moves to the menu.</p>

		<figure>
			<img alt="Wide nav bar showing all of the links" src=images/menu-wide.png>
			<figcaption>
				Wide rendering with menu shown
			</figcaption>
		</figure>

		<figure>
			<img alt="Narrow nav bar with some of the links in the menu" src=images/menu-narrow.png>
			<figcaption>
				Narrow rendering with menu shown
			</figcaption>
		</figure>

	</div>

	<div class=example>

<p>Since content is assigned to a <span class=css>named flow</span> using a CSS selector, the content can come from multiple sources. The resulting aggregation can be displayed in a single box or flowed through multiple boxes as above.</p>

<p>So given this markup:</p>

		<pre><code class=html>
  &lt;div class="breaking-news"&gt;&lt;/div&gt;
  &lt;article&gt;News story&lt;/article&gt;
  &lt;article class="breaking"&gt;Sports story&lt;/article&gt;
  &lt;article&gt;News story&lt;/article&gt;
  &lt;article class="breaking"&gt;Entertainment story&lt;/article&gt;
  &lt;article&gt;Sports story&lt;/article&gt;
</code></pre>

<p>You can take the "breaking" stories and display them above all the others using two lines of CSS:</p>

		<pre><code>
  .breaking {
    flow-into: breaking-news;
  }
  .breaking-news {
    flow-from: breaking-news;
  }
</code></pre>

<p>Given more data accessible to CSS selectors, you could rearrange the articles in other ways (sports on top, etc.) depending on the user’s preferences.</p>

	</div>

	<div class=note><span class=note-prefix>Note </span>

<p><strong><span class=css>CSS Regions</span> are independent from layout</strong></p>

<p>Any of the CSS layout facilities can be used
		to create, position and size boxes that can become <span class=css>CSS Regions</span>.</p>

<p>The CSS Regions module does not
		define a layout mechanism 
		and is meant to integrate 
		with existing and future CSS layout facilities.</p>
	</div>

	<div class=note><span class=note-prefix>Note </span>

<p><strong><span class=css>CSS Regions</span> do not have to be elements</strong></p>

<p>The CSS Regions module is independent
		of the layout of boxes and 
		the mechanisms used to create them.</p>

<p>For simplicity,
		our examples tend to
		use elements to define the boxes. 
		Any other mechanism available 
		in markup or style 
		to create stylable boxes could be used instead, 
		such as pseudo-elements 
		or the @slot rule proposed 
		by the CSS Page Template Module <a data-biblio-type=informative data-link-type=biblio href=#biblio-css3-page-template title=CSS3-PAGE-TEMPLATE>[CSS3-PAGE-TEMPLATE]</a>.</p>


<p>The only requirement
		for box to become a <span class=css>CSS Region</span>
		is that the <a class=property data-link-type=propdesc href=#propdef-flow-from title=flow-from>flow-from</a> property applies to the box.</p>
	</div>

<h2 class="heading settled" data-level=2 id=css-regions-concepts><span class=secno>2. </span><span class=content>
CSS Regions concepts</span><a class=self-link href=#css-regions-concepts></a></h2>

<h3 class="heading settled" data-level=2.1 id=regions><span class=secno>2.1. </span><span class=content>
Regions</span><a class=self-link href=#regions></a></h3>

<p>A <dfn data-dfn-type=dfn data-noexport="" id=css-region>CSS Region<a class=self-link href=#css-region></a></dfn>
	is a block container 
	that has an associated 
	<em><span class=css>named flow</span></em> 
	(see the <a class=property data-link-type=propdesc href=#propdef-flow-from title=flow-from>flow-from</a> property).</p>

<h3 class="heading settled" data-level=2.2 id=region-chain-section><span class=secno>2.2. </span><span class=content>
Region chain</span><a class=self-link href=#region-chain-section></a></h3>

<p>A <dfn data-dfn-type=dfn data-noexport="" id=region-chain>region chain<a class=self-link href=#region-chain></a></dfn>
	is the sequence of regions 
	that are associated with 
	a <span class=css>named flow</span>. 
	<span class=css>CSS Regions</span> in a 
	region chain receive content from the 
	<span class=css>named flow</span> following their order in the chain. 
	<span class=css>CSS Regions</span> are organized 
	into a <span class=css>region chain</span> 
	according to the document order.</p>

<h3 class="heading settled" data-level=2.3 id=named-flow-section><span class=secno>2.3. </span><span class=content>
Named flows</span><a class=self-link href=#named-flow-section></a></h3>

<p>A <dfn data-dfn-type=dfn data-noexport="" id=named-flow>named flow<a class=self-link href=#named-flow></a></dfn> is the ordered sequence of content
	associated with a flow with a given identifier. 
	Contents in a <span class=css>named flow</span> are ordered
	according to the document order.</p>

<p>Content is placed into a <span class=css>named flow</span>
	with the <a class=property data-link-type=propdesc href=#propdef-flow-into title=flow-into>flow-into</a> property. 
	The content in a <span class=css>named flow</span> is laid out 
	in the <span class=css>region chain</span> 
	that is associated with this <span class=css>named flow</span> 
	using the <a class=property data-link-type=propdesc href=#propdef-flow-from title=flow-from>flow-from</a> property.</p>

<p>Content from a <span class=css>named flow</span>
	is broken up between regions 
	according to the regions flow breaking rules.</p>

<p>A <span class=css>named flow</span> is created when
	some content is moved 
	into the flow with the given identifier 
	or when at least one <span class=css>CSS Region</span> 
	requests content from that flow.</p>

<h3 class="heading settled" data-level=2.4 id=regions-flow-breaking-rules><span class=secno>2.4. </span><span class=content>
Regions flow breaking rules</span><a class=self-link href=#regions-flow-breaking-rules></a></h3>

<p>Breaking a <span class=css>named flow</span> across a region chain
	is similar to breaking a document’s content across pages 
	(see <a data-biblio-type=informative data-link-type=biblio href=#biblio-css3page title=CSS3PAGE>[CSS3PAGE]</a>) 
	or a multi-column element’s content across column boxes 
	(see <a data-biblio-type=informative data-link-type=biblio href=#biblio-css3col title=CSS3COL>[CSS3COL]</a>). 
	One difference is that page boxes are generated 
	based on the available content 
	whereas a region chain is a set of recipient boxes 
	for the <span class=css>named flow</span> content 
	whose dynamic generation is not in the scope 
	of this specification.</p>

<p>Each <span class=css>CSS Region</span> in turn
	consumes content from its associated <span class=css>named flow</span>. 
	The <span class=css>named flow</span> content is positioned 
	in the current region 
	until a natural or forced region break occurs, 
	at which point the next region 
	in the <span class=css>region chain</span> 
	becomes the current region. 
	If there are no more <span class=css>CSS Regions</span> 
	in the <span class=css>region chain</span> 
	and there is still content in the flow, 
	the positioning of the remaining content 
	is controlled by the <a class=property data-link-type=propdesc href=#propdef-region-fragment title=region-fragment>region-fragment</a> property 
	on the last <span class=css>CSS Region</span> in the chain.</p>

<p>The CSS regions module follows
	the fragmentation rules defined 
	in the CSS Fragmentation Module Level 3 
	(see <a data-biblio-type=normative data-link-type=biblio href=#biblio-css3-break title=CSS3-BREAK>[CSS3-BREAK]</a>).</p>


<h2 class="heading settled" data-level=3 id=properties><span class=secno>3. </span><span class=content>
Properties</span><a class=self-link href=#properties></a></h2>

<h3 class="heading settled" data-level=3.1 id=the-flow-into-property><span class=secno>3.1. </span><span class=content>
The <a class=property data-link-type=propdesc href=#propdef-flow-into title=flow-into>flow-into</a> property</span><a class=self-link href=#the-flow-into-property></a></h3>

	<div class="issue-marker wrapper">
	<div class=issue-marker>
		<a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=16527">Issue-16527</a>
		<div class=issue-details>
				<p class=short-desc>[Shadow]: getFlowByName and shadow DOM</p>
		</div>
	</div>
	</div>

<p>The ‘flow-into’ property can place an element
	or its contents 
	into a <span class=css>named flow</span>. 
	Content that belongs to the same flow 
	is laid out in the region chain 
	associated with that flow.</p>

<table class="definition propdef"><tr><th>Name:<td><dfn class=css data-dfn-type=property data-export="" id=propdef-flow-into>flow-into<a class=self-link href=#propdef-flow-into></a></dfn><tr><th>Value:<td class=prod>none <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> <a class="production css" data-link-type=type href=http://www.w3.org/TR/mediaqueries-4/#typedef-ident title="<ident>">&lt;ident&gt;</a> [element<a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a>content]<a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#mult-opt title=?>?</a><tr><th>Initial:<td>none<tr><th>Applies to:<td>All elements, but not <a href=http://www.w3.org/TR/selectors/#pseudo-elements>pseudo-elements</a> such as <code>::first-line</code>, <code>::first-letter</code>, <code>::before</code> or <code>::after</code>.<tr><th>Inherited:<td>no<tr><th>Media:<td>visual<tr><th>Computed value:<td>as specified</table>

	<dl>
		<dt>none</dt>

		<dd>
			The element is not moved 
			to a <span class=css>named flow</span> 
			and normal CSS processing takes place.
		</dd>

		<dt><a href=http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier>&lt;ident&gt;</a></dt>

		<dd>
			If the keyword <dfn data-dfn-type=dfn data-noexport="" id=element>element<a class=self-link href=#element></a></dfn> is present 
			or neither keyword is present, 
			then the element is taken out 
			of its parent’s flow
			and placed into the flow 
			with the name '<a href=http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier>&lt;ident&gt;</a>'. 
			If the keyword <dfn data-dfn-type=dfn data-noexport="" id=content>content<a class=self-link href=#content></a></dfn> is present, 
			then only the element’s contents 
			are placed into the named flow. 
			The element or content is said to have 
			a <dfn data-dfn-type=dfn data-noexport="" id=specified-flow>specified flow<a class=self-link href=#specified-flow></a></dfn>. 
			The values <span class=css>none</span>, <span class=css>inherit</span>, <span class=css>default</span>, <span class=css>auto</span> and <span class=css>initial</span>
			are invalid flow names.
		</dd>
	</dl>

<p>The <a class=property data-link-type=propdesc href=#propdef-flow-into title=flow-into>flow-into</a> property affects
	the visual formatting of elements or contents 
	placed into a <span class=css>named flow</span> 
	and of the region chain laying out content 
	from a <span class=css>named flow</span>. 
	The <a class=property data-link-type=propdesc href=#propdef-flow-into title=flow-into>flow-into</a> property does not affect 
	the CSS cascade and inheritance 
	for the elements on which it is specified. 
	The <a class=property data-link-type=propdesc href=#propdef-flow-into title=flow-into>flow-into</a> property does not affect the 
	<a href=http://www.w3.org/TR/2012/WD-dom-20120405/#introduction-to-the-dom>DOM</a> 
	<a data-biblio-type=normative data-link-type=biblio href=#biblio-dom title=DOM>[DOM]</a> position of an element or its contents. 
	The <a class=property data-link-type=propdesc href=#propdef-flow-into title=flow-into>flow-into</a> property does not affect ordering 
	in non-visual media 
	(such as <a href=http://www.w3.org/TR/css3-speech/>speech</a>). 
	Likewise, <a class=property data-link-type=propdesc href=#propdef-flow-into title=flow-into>flow-into</a> does not affect 
	the default traversal order 
	of sequential navigation modes 
	(such as cycling through links, 
	see e.g. <a class=property data-link-type=propdesc href=http://www.w3.org/TR/css3-ui/#nav-index0 title=nav-index>nav-index</a> <a data-biblio-type=informative data-link-type=biblio href=#biblio-css3ui title=CSS3UI>[CSS3UI]</a> 
	or <a href=https://html.spec.whatwg.org/multipage/interaction.html#sequential-focus-navigation><code>tabindex</code></a> <a data-biblio-type=informative data-link-type=biblio href=#biblio-html40 title=HTML40>[HTML40]</a>).</p>

<p>A <span class=css>named flow</span> needs to be associated
	with a region chain 
	(one or more <span class=css>CSS Regions</span>) 
	for its content to be visually formatted. 
	If no region chain is associated 
	with a given <span class=css>named flow</span>, 
	the content in the <span class=css>named flow</span> 
	is not rendered: 
	it does not generate boxes 
	and is not displayed.</p>

<p>The children of an element or content
	with a specified flow 
	may themselves have a specified flow, 
	in which case they become 
	the next sibling of the latest element 
	or content collected in that flow. 
	In some cases, 
	the child can become the next sibling 
	for one of its ancestors in the same flow.</p>

<p>Content in a <span class=css>named flow</span>
	is sequenced in document order. 
	The visual formatting model 
	uses the relationships between content 
	in the named flow as input, 
	rather than the contents’ position 
	in the DOM.</p>

<p>Each <span class=css>CSS region</span> in a <span class=css>region chain</span>
	establishes a containing block for absolutely positioned 
	elements in the <span class=css>named flow</span> (see <a data-biblio-type=normative data-link-type=biblio href=#biblio-css21 title=CSS21>[CSS21]</a>).
	That first <span class=css>CSS region</span> in a <span class=css>region chain</span>
	establishes the initial containing block for such absolutely
	positioned elements. 
	<span>Regions</span> don’t establish a containing block for 
	fixed positioned elements in the <span class=css>named flow</span>.
	Such fixed positioned elements are still positioned relative 
	to the viewport or the page area even if they have been 
	redirected into a named flow</p>

<p>The first region defines the principal
	<a href=http://www.w3.org/TR/css3-writing-modes/#writing-mode>writing mode</a> 
	for the entire flow. 
	The writing mode 
	on subsequent regions is ignored.</p>

	<div class=note><span class=note-prefix>Note </span>

<p>The <a class=property data-link-type=propdesc href=#propdef-flow-into title=flow-into>flow-into</a> property moves an element into the flow
		and the interplay with selectors should be considered carefully.</p>

<p>For example,</p>

<pre>table {flow-into: table-content}</pre>

<p>will move all tables in the "table-content"
		<span class=css>named flow</span>. 
		However, the</p>

<pre>table &gt; * {flow-into: table-content} ...</pre>

<p>selector will move all immediate children
		of all table elements 
		into the "table-content" <span class=css>named flow</span> 
		(which may be useful as it will usually result, 
		if the immediate children are rows, 
		in merging rows of multiple tables), 
		but the</p>

<pre>table * {flow-into: table-content}</pre>

<p>selector will move all descendants
		of table elements into the "table-content" <span class=css>named flow</span>, 
		transforming the element tree 
		into a flat list in order of opening tags 
		(which is probably not intentional). 
		This will make all the descendants 
		of table elements siblings 
		in the <span class=css>named flow</span>. 
		Having the descendants become siblings 
		in the <span class=css>named flow</span> 
		results in a different processing 
		(see <a href=http://www.w3.org/TR/2011/REC-CSS2-20110607/tables.html#anonymous-boxes>CSS 2.1’s anonymous table objects</a>). 
		This note illustrates how authors must exercise caution 
		when choosing a particular selector 
		for setting the <a class=property data-link-type=propdesc href=#propdef-flow-into title=flow-into>flow-into</a> property 
		to avoid unintended results.</p>
	</div>

	<div class=note><span class=note-prefix>Note </span>

<p>Another consequence of moving elements
		into named flows is that surrounding whitespace 
		is not moved into the named flow. 
		If you have code like this:</p>

		<pre>span {flow-into: span-content}
&lt;span&gt;one&lt;/span&gt;
&lt;span&gt;two&lt;/span&gt;
</pre>

<p>Then the "span-content" named flow contents
		will contain this:</p>

		<pre>&lt;span&gt;one&lt;/span&gt;&lt;span&gt;two&lt;/span&gt;
</pre>

<p>Which will change the display
		from "one two" to "onetwo".
		If whitespace is significant, 
		then moving the parent 
		that contains the whitespace 
		to the named flow 
		is required.</p>
	</div>

<h3 class="heading settled" data-level=3.2 id=flow-from><span class=secno>3.2. </span><span class=content>
The <a class=property data-link-type=propdesc href=#propdef-flow-from title=flow-from>flow-from</a> property</span><a class=self-link href=#flow-from></a></h3>

<p>The <a class=property data-link-type=propdesc href=#propdef-flow-from title=flow-from>flow-from</a> property makes
	a block container a region 
	and associates it with 
	a <span class=css>named flow</span>.</p>

<table class="definition propdef"><tr><th>Name:<td><dfn class=css data-dfn-type=property data-export="" id=propdef-flow-from>flow-from<a class=self-link href=#propdef-flow-from></a></dfn><tr><th>Value:<td class=prod><a class="production css" data-link-type=type href=http://www.w3.org/TR/mediaqueries-4/#typedef-ident title="<ident>">&lt;ident&gt;</a> <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> none <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> inherit<tr><th>Initial:<td>none<tr><th>Applies to:<td>Non-replaced <a href=http://www.w3.org/TR/CSS21/visuren.html#block-boxes>block containers</a>. <br> This might be expanded in future versions of the specification to allow other types of containers to receive flow content.<tr><th>Inherited:<td>no<tr><th>Media:<td>visual<tr><th>Computed value:<td>as specified</table>

	<dl>
		<dt><strong>none</strong></dt>

		<dd>
			The block container is not a <span class=css>CSS Region</span>.
		</dd>

		<dt><strong><a href=http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier>&lt;ident&gt;</a></strong></dt>

		<dd>
			The block container becomes a <span class=css>CSS Region</span> 
			(except as detailed in the text below), 
			and is ordered in a <span class=css>region chain</span> 
			according to its document order. 
			The content from the flow 
			with the <a href=http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier>&lt;ident&gt;</a>
			name will be <a href=#region-flow-break>broken 
			into fragments</a> and visually formatted in the 
			<a href=http://www.w3.org/TR/CSS21/visuren.html#principal-box>principal boxes</a> 
			of the <span>regions</span> 
			in the <span class=css>region chain</span>. 
			<br>
			If there is no flow with name 
			<a href=http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier>&lt;ident&gt;</a>, 
			then the block container does not 
			format any content visually. 
		</dd>
	</dl>

<p>If the <a class=property data-link-type=propdesc href=http://dev.w3.org/csswg/css-content-3/#content title=content>content</a> property computes
	to something else than <span class=css>normal</span> 
	(or <span class=css>none</span> for a pseudo-element), 
	the block container does not become 
	a <span class=css>CSS Region</span>. 
	If the <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visuren.html#propdef-display title=display>display</a> property 
	of the block container 
	or one of its ancestors 
	computes to <span class=css>none</span>, 
	the block container does not become 
	a <span class=css>CSS Region</span>.</p>

<p>A <span class=css>CSS Region</span>’s document children
	are not visually formatted 
	unless they are directed 
	to a <span class=css>named flow</span> 
	with an associated <span class=css>region chain</span>.</p>

<p>Block container pseudo-elements where
	the value of <a class=property data-link-type=propdesc href=#propdef-flow-from title=flow-from>flow-from</a> computes to an 
	<a href=http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier>&lt;ident&gt;</a> 
	and the value of <a class=property data-link-type=propdesc href=http://dev.w3.org/csswg/css-content-3/#content title=content>content</a> computes to <span class=css>none</span> 
	are generated as <span class=css>CSS Regions</span>, 
	which is an update to the behavior 
	described in <a data-biblio-type=normative data-link-type=biblio href=#biblio-css21 title=CSS21>[CSS21]</a>.</p>

	<div class=note><span class=note-prefix>Note </span>

<p>A block container becomes a <span class=css>CSS Region</span>
		when its <a class=property data-link-type=propdesc href=#propdef-flow-from title=flow-from>flow-from</a> property is set 
		to a valid <a href=http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier>&lt;ident&gt;</a> value, 
		even if there is no content contributing 
		to the referenced flow.
		For example:</p>

		<pre>&lt;style&gt;
.article{
    flow-into: thread;
}
.region{
    flow-from: thread;
}
&lt;/style&gt;
&lt;html&gt;
&lt;body&gt;
  &lt;div class=region&gt;div content&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>

<p>There is no element matching
		the <code>.article</code> selector 
		and therefore no content 
		in the <code>thread</code> flow. 
		However, the block container matching 
		the <code>.region</code> selector 
		is still associated with 
		that empty <span class=css>named flow</span> 
		and, consequently, 
		its children are not formatted visually.</p>
	</div>

	<div class=note><span class=note-prefix>Note </span>

<p>At the time of this note-writing, the <code>display</code> values that
		always result in a non-replaced block container include
		<code>block</code>, <code>inline-block</code>, <code>table-cell</code>,
		<code>table-caption</code>, and <code>list-item</code>. All of these
		display values work as regions with non-replaced elements.</p>

<p>The <code>flex</code> and <code>grid</code> display values do not
		result in block containers (they are defined as flex containers and grid
		elements, respectively). So ‘<a href=#flow-from><code class=property>flow-from</code></a>’ combined with those display values
		does not result in a <span class=css>CSS Region</span>.</p>
	</div>

<p><span class=css>CSS Regions</span>
	create a new 
	<a href=http://www.w3.org/TR/CSS2/visuren.html#z-index>stacking context</a>. 
	<span class=css>CSS Regions</span> 
	establish a new 
	<a href=http://www.w3.org/TR/CSS2/visuren.html#block-formatting>block formatting Context</a>. 
	Exclusions (see <a data-biblio-type=informative data-link-type=biblio href=#biblio-css3-exclusions title=CSS3-EXCLUSIONS>[CSS3-EXCLUSIONS]</a>) 
	potentially impact the content 
	laid out in region chains, 
	just as for non-regions.</p>

	<div class=note><span class=note-prefix>Note </span>

<p>With <span class=css>region chains</span>,
		an element may be split across multiple boxes 
		and these boxes may overlap 
		(for example if they are absolutely positioned). 
		So fragments of the same element 
		can overlap each other. 
		Since each element has a single z-index, 
		it would be required to find another mechanism 
		to decide in which order 
		the fragments are rendered. 
		Since each <span class=css>CSS Region</span> creates 
		a new stacking context, 
		it is clear that each fragment is rendered separately 
		and their rendering order follows 
		the regular CSS rendering model.</p>

<p>Fragments rendering separately
		is also relevant to elements that might normally 
		be rendered as a unit 
		(for example, 
		an element with its own stacking context, 
		or with transparency). 
		Each fragment of these elements 
		is separately contained in the stacking context 
		created by the <span class=css>CSS Region</span>, 
		so each fragment of these elements 
		is rendered separately.</p>
	</div>

<p>See the
	<a href=#regions-visual-formatting-details>regions visual formatting details</a> 
	section for a description of how 
	<a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-width title=width>width</a> and <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-height title=height>height</a> values are resolved 
	for <span class=css>CSS Region</span> boxes.</p>

<h4 class="heading settled" data-level=3.2.1 id=circular-dependencies><span class=secno>3.2.1. </span><span class=content>
Cycle Detection</span><a class=self-link href=#circular-dependencies></a></h4>

<p><span class=css>named flows</span> containing elements
	where the value of <a class=property data-link-type=propdesc href=#propdef-flow-from title=flow-from>flow-from</a> computes to an 
	<a href=http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier>&lt;ident&gt;</a> 
	can produce nonsensical circular relationships,
	such as a <span class=css>named flow</span> 
	containing <span class=css>CSS Regions</span> 
	in its own <span class=css>region chain</span>. 
	These relationships can be easily 
	and reliably detected and resolved, however, 
	by keeping track of a dependency graph 
	and using common cycle-detection algorithms.</p>

<p>The dependency graph consists of edges such that:</p>

<ul>
	<li>
		Every <span class=css>named flow</span> depends on its elements 
		where the value of <a class=property data-link-type=propdesc href=#propdef-flow-from title=flow-from>flow-from</a> computes to an 
		<a href=http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier>&lt;ident&gt;</a>.
	</li>
	<li>
		Every element in a <span class=css>named flow</span> 
		where the value of <a class=property data-link-type=propdesc href=#propdef-flow-from title=flow-from>flow-from</a> computes to an 
		<a href=http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier>&lt;ident&gt;</a> 
		depends on the <span class=css>named flow</span> with the 
		<a href=http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier>&lt;ident&gt;</a> 
		name.
	</li>
</ul>

<p>If the graph contains a cycle,
	any elements where the value of <a class=property data-link-type=propdesc href=#propdef-flow-from title=flow-from>flow-from</a> 
	computes to an 
	<a href=http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier>&lt;ident&gt;</a> 
	participating in the cycle 
	do not become <span class=css>CSS Regions</span>.</p>

	<div class=note><span class=note-prefix>Note </span>

<p>For example, styling like this:</p>

		<pre>#id {
  flow-into: foolish;
  flow-from: foolish;
}
</pre>

<p>would move the <code>#id</code> element to a "foolish" <span class=css>named flow</span>,
		and try to make the <code>#id</code> element 
		a <span class=css>CSS Region</span> for the "foolish" <span class=css>named flow</span>. 
		The "foolish" <span class=css>named flow</span> would then contain its own region, 
		creating a cycle. 
		So the <code>#id</code> element does not become a <span class=css>CSS Region</span>.</p>
	</div>

<h4 class="heading settled" data-level=3.2.2 id=fragmenting-regions><span class=secno>3.2.2. </span><span class=content>
Nested fragmentation contexts</span><a class=self-link href=#fragmenting-regions></a></h4>

<p>A <span class=css>CSS Region</span> that contains
	a fragment of a <span class=css>named flow</span> 
	can itself be fragmented if it is nested 
	within a fragmentation context <a data-biblio-type=normative data-link-type=biblio href=#biblio-css3-break title=CSS3-BREAK>[CSS3-BREAK]</a>, 
	such as when a layout 
	using a region chain is printed. 
	In these cases break opportunities 
	in the named flow fragment 
	contained by the <span class=css>CSS Region</span> 
	are determined using the standard 
	<a href=http://www.w3.org/TR/css3-break/>fragmentation rules</a>. 
	In other words, 
	each region box and its associated fragment 
	should break as if it were a simple div 
	containing the fragment contents. 
	This can be controlled by using 
	an avoid break value on the <span class=css>CSS Region</span>, 
	if that is desired.</p>

<p>A <span class=css>CSS Region</span> can be part
	of the contents of a separate named flow, 
	as long as there are no cycles broken 
	by the <a href=#circular-dependencies>Cycle Detection</a> 
	described above. 
	This case is a <dfn data-dfn-type=dfn data-noexport="" id=nested-region-context>nested region context<a class=self-link href=#nested-region-context></a></dfn>, 
	which has an effect 
	on the <a href=#regions-visual-formatting-steps>Visual Formatting Steps</a> 
	described below.</p>

<h3 class="heading settled" data-level=3.3 id=region-flow-break><span class=secno>3.3. </span><span class=content>
Region flow break properties: <a class=property data-link-type=propdesc href=#propdef-break-before title=break-before>break-before</a>, <a class=property data-link-type=propdesc href=#propdef-break-after title=break-after>break-after</a>, <a class=property data-link-type=propdesc href=#propdef-break-inside title=break-inside>break-inside</a></span><a class=self-link href=#region-flow-break></a></h3>

<div class=note><span class=note-prefix>Note </span>

<p>This section is also defined in <a data-biblio-type=normative data-link-type=biblio href=#biblio-css3-break title=CSS3-BREAK>[CSS3-BREAK]</a>.
	If that specification moves to last call 
	with the region values, 
	the section here can be replaced by a reference.</p>
</div>

<p>User agents laying out content in multiple regions
	must determine where content breaks occur. 
	The problem of breaking content into fragments fitting in regions 
	is similar to breaking content into pages or columns.</p>

<p>Each break ends layout in the current region
	and causes remaining pieces of content 
	from the <span class=css>named flow</span> to be visually formatted 
	in the following region in the region chain, 
	if there is one.</p>

<p>The following extends
	the <a class=property data-link-type=propdesc href=#propdef-break-before title=break-before>break-before</a>, <a class=property data-link-type=propdesc href=#propdef-break-after title=break-after>break-after</a> and <a class=property data-link-type=propdesc href=#propdef-break-inside title=break-inside>break-inside</a> properties 
	from the <a data-biblio-type=normative data-link-type=biblio href=#biblio-css3col title=CSS3COL>[CSS3COL]</a> specification to account for regions. 
	The additional values are described below.</p>

<table class="definition propdef"><tr><th>Name:<td><dfn class=css data-dfn-type=property data-export="" id=propdef-break-before>break-before<a class=self-link href=#propdef-break-before></a></dfn><tr><th>Value:<td class=prod>auto <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> always <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> avoid <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> left <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> right <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> page <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> column <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> region <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> avoid-page <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> avoid-column <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> avoid-region<tr><th>Initial:<td>auto<tr><th>Applies to:<td>block-level elements<tr><th>Inherited:<td>no<tr><th>Media:<td>visual<tr><th>Computed value:<td>as specified</table>

<table class="definition propdef"><tr><th>Name:<td><dfn class=css data-dfn-type=property data-export="" id=propdef-break-after>break-after<a class=self-link href=#propdef-break-after></a></dfn><tr><th>Value:<td class=prod>auto <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> always <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> avoid <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> left <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> right <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> page <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> column <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> region <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> avoid-page <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> avoid-column <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> avoid-region<tr><th>Initial:<td>auto<tr><th>Applies to:<td>block-level elements<tr><th>Inherited:<td>no<tr><th>Media:<td>visual<tr><th>Computed value:<td>as specified</table>

<table class="definition propdef"><tr><th>Name:<td><dfn class=css data-dfn-type=property data-export="" id=propdef-break-inside>break-inside<a class=self-link href=#propdef-break-inside></a></dfn><tr><th>Value:<td class=prod>auto <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> avoid <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> avoid-page <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> avoid-column <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> avoid-region<tr><th>Initial:<td>auto<tr><th>Applies to:<td>block-level elements<tr><th>Inherited:<td>no<tr><th>Media:<td>visual<tr><th>Computed value:<td>as specified</table>

<p>These properties describe page, column and region break behavior
	before/after/inside the generated box. These values are normatively defined
	in <a data-biblio-type=normative data-link-type=biblio href=#biblio-css3col title=CSS3COL>[CSS3COL]</a>:</p>

<p>This specification adds the following new values:</p>

	<dl>
		<dt>region</dt>

		<dd>Always force a region break before (after) the generated box.</dd>

		<dt>avoid-region</dt>

		<dd>Avoid a region break before (after, inside) the generated box.</dd>
	</dl>

<p>The behavior of region breaks with regards to regions
	is identical to the behavior of page breaks with regards to pages, 
	as defined in the <a data-biblio-type=normative data-link-type=biblio href=#biblio-css21 title=CSS21>[CSS21]</a>.</p>

<h3 class="heading settled" data-level=3.4 id=the-region-fragment-property><span class=secno>3.4. </span><span class=content>
The region-fragment property</span><a class=self-link href=#the-region-fragment-property></a></h3>

<table class="definition propdef"><tr><th>Name:<td><dfn class=css data-dfn-type=property data-export="" id=propdef-region-fragment>region-fragment<a class=self-link href=#propdef-region-fragment></a></dfn><tr><th>Value:<td class=prod>auto <a class=prod-punc data-link-type=grammar href=http://dev.w3.org/csswg/css-values-3/#comb-one title=|>|</a> break<tr><th>Initial:<td>auto<tr><th>Applies to:<td><span class=css>CSS Regions</span><tr><th>Inherited:<td>no<tr><th>Media:<td>visual<tr><th>Computed value:<td>as specified</table>

<p>The <a class=property data-link-type=propdesc href=#propdef-region-fragment title=region-fragment>region-fragment</a> property controls the behavior
	of the <em id=last-region>last region</em> 
	associated with a <span class=css>named flow</span>.</p>

	<dl>
		<dt>auto</dt>

		<dd>
			Content flows as it would in a regular content box. 
			If the content exceeds the container box, 
			it is subject to the 
			<a href=http://www.w3.org/TR/CSS21/visufx.html#propdef-overflow>overflow</a> 
			property’s computed value on the <span class=css>CSS Region</span>. 
			Region breaks must be ignored on the last region.
		</dd>

		<dt>break</dt>

		<dd>

<p>If the content fits within the <span class=css>CSS Region</span>,
			then this property has no effect. 
			If the content does not fit within the <span class=css>CSS Region</span>, 
			the content breaks as if flow was going to continue in a subsequent region. 
			See the <a href=#regions-flow-breaking-rules>breaking rules</a> section. 
			A forced region break takes precedence over a natural break point.</p>

<p>Flow content that follows the last break in the last region is not rendered.</p>
		</dd>
	</dl>

<p>The <a class=property data-link-type=propdesc href=#propdef-region-fragment title=region-fragment>region-fragment</a> property does not influence
	the size of the region it applies to.</p>

<p>The following code sample illustrates
	the usage of the <a class=property data-link-type=propdesc href=#propdef-region-fragment title=region-fragment>region-fragment</a> property.</p>

	<div class=example>
		<pre>&lt;style&gt;
  article {
    flow-into: article-flow;
  }
  #region-1, #region-2 {
    flow-from: article-flow;
    <strong>region-fragment: break;</strong> /* or auto */
    <strong>overflow: visible;</strong> /* or hidden */
  }
&lt;/style&gt;
&lt;body&gt;
  &lt;article&gt;...&lt;/article&gt;
  &lt;div id="region-1"&gt;&lt;/div&gt;
  &lt;div id="region-2"&gt;&lt;/div&gt;
&lt;/body&gt;
</pre>
	</div>

	<figure>
		<table style="border: 1px solid gray;width: 100%;">
			<tr>
				<td>article with two<br>
				overflowing lines</td>

				<td><code>region-fragment: break<br>
				overflow: visible</code></td>

				<td><code>region-fragment: auto<br>
				overflow: visible</code></td>
			</tr>

			<tr>
				<td rowspan=3 style="vertical-align: top;"><img alt="flow content rendering" src=images/region-overflow-flow.png></td>

				<td><img alt="rendering with region-fragment:break and overflow:visible" src=images/region-overflow-break-visible.png></td>

				<td><img alt="rendering with region-fragment:auto and overflow:visible" src=images/region-overflow-auto-visible.png></td>
			</tr>

			<tr>
				<td><code>region-fragment: break<br>
					overflow: hidden</code></td>

				<td><code>region-fragment: auto<br>
				overflow: hidden</code></td>
			</tr>

			<tr>
				<td><img alt="rendering with region-fragment:break and overflow:hidden" src=images/region-overflow-break-hidden.png></td>

				<td><img alt="rendering with region-fragment:auto and overflow:hidden" src=images/region-overflow-auto-hidden.png></td>
			</tr>
		</table>

		<figcaption>
			Combinations of region-fragment and overflow.
		</figcaption>
	</figure>

	<div class=note><span class=note-prefix>Note </span>

<p>The <a class=property data-link-type=propdesc href=http://www.w3.org/TR/css-overflow-3/#overflow title=overflow>overflow</a> property is honored on a region:
		if region content overflows, 
		such as the borders of elements 
		on the last line, 
		the <a class=property data-link-type=propdesc href=http://www.w3.org/TR/css-overflow-3/#overflow title=overflow>overflow</a> property controls 
		the visibility of the overflowing content. 
		See the <a class=property data-link-type=propdesc href=http://www.w3.org/TR/css-overflow-3/#overflow title=overflow>overflow</a> property definition (<a data-biblio-type=informative data-link-type=biblio href=#biblio-css21 title=CSS21>[CSS21]</a>).</p>
	</div>

<h2 class="heading settled" data-level=4 id=cssom_view_and_css_regions><span class=secno>4. </span><span class=content>
CSSOM</span><a class=self-link href=#cssom_view_and_css_regions></a></h2>

<p>Since content may flow into multiple regions,
	authors need a way to determine if there are enough regions 
	to flow all the content from a named flow. 
	This is especially important considering that the size of regions 
	or the size of the content may change depending on the display context. 
	For example, 
	flowing the same content on a mobile phone with a small screen 
	may require more regions than on a large desktop display. 
	Another example is the user changing 
	the font size of text flowing through regions. 
	Depending on the change, 
	new regions may be needed to accommodate for the additional space required 
	to fit the larger text or some regions may need to be removed for smaller text.</p>

<h3 class="heading settled" data-level=4.1 id=the-namedflow-interface><span class=secno>4.1. </span><span class=content>
The NamedFlow interface</span><a class=self-link href=#the-namedflow-interface></a></h3>

<p>The following APIs allow scripts
	to reference a <a data-link-type=idl href=#dom-namedflow title=NamedFlow>NamedFlow</a> 
	object representation of a <span class=css>named flow</span>.</p>

<p>An additional attribute on the
	<a href=http://www.w3.org/TR/dom/#interface-document>
		<code class=idl>Document</code></a>
	interface provide access to <span class=css>named flows</span>.</p>

	<pre class=idl>partial interface <a class=idl-code data-global-name="" data-link-type=interface href=http://dom.spec.whatwg.org/#document title=Document>Document</a> {
  readonly attribute <a data-link-type=idl href=#dom-namedflowmap title=NamedFlowMap>NamedFlowMap</a> <a class=idl-code data-global-name="Document<interface>/namedflows<attribute>" data-link-for=Document data-link-type=attribute data-readonly="" data-type="NamedFlowMap " href=#dom-document-namedflows title=namedFlows>namedFlows</a>;
};
</pre>

<p>The
	<dfn data-dfn-type=dfn data-noexport="" id=document-namedflows><code class=idl>namedFlows</code><a class=self-link href=#document-namedflows></a></dfn> 
	attribute on the 
	<a href=http://www.w3.org/TR/dom/#interface-document>
		<code class=idl>Document</code>
	</a> 
	interface returns a static snapshot 
	of all the current <span class=css>named flows</span> 
	in the document.</p>

<p>The <dfn class=idl-code data-dfn-for=Document data-dfn-type=attribute data-export="" id=dom-document-namedflows><code class=idl>namedFlows</code><a class=self-link href=#dom-document-namedflows></a></dfn>
	map must include all <span class=css>named flows</span> 
	that are currently in the <code>CREATED</code> state. 
	The list must not include <span class=css>named flows</span> 
	that are in the <code>NULL</code> state.</p>

<p>The
	<dfn class=idl-code data-dfn-type=interface data-export="" id=dom-namedflowmap><code class=idl>NamedFlowMap</code><a class=self-link href=#dom-namedflowmap></a></dfn>
	interface provides a map of current 
	<a data-link-type=idl href=#dom-namedflow title=NamedFlow>NamedFlow</a> instances 
	in the document. 
	The <a data-link-type=idl href=#dom-namedflowmap title=NamedFlowMap>NamedFlowMap</a> object 
	is a snapshot of the data, 
	and is read-only.</p>

	<pre class=idl>[MapClass(DOMString, <a data-link-type=idl href=#dom-namedflow title=NamedFlow>NamedFlow</a>)] interface <a class=idl-code data-global-name="" data-link-type=interface href=#dom-namedflowmap title=NamedFlowMap>NamedFlowMap</a> {
  <a data-link-type=idl href=#dom-namedflow title=NamedFlow>NamedFlow</a>? <a class=idl-code data-global-name="NamedFlowMap<interface>/get()<method>" data-link-for=NamedFlowMap data-link-type=method href=#dom-namedflowmap-get title=get()>get</a>(DOMString <dfn class=idl-code data-dfn-for=NamedFlowMap/get() data-dfn-type=argument data-export="" data-global-name="NamedFlowMap<interface>/get()<method>/flowname<argument>" id=dom-namedflowmap-get-flowname>flowName<a class=self-link href=#dom-namedflowmap-get-flowname></a></dfn>);
  boolean <a class=idl-code data-global-name="NamedFlowMap<interface>/has()<method>" data-link-for=NamedFlowMap data-link-type=method href=#dom-namedflowmap-has title=has()>has</a>(DOMString <dfn class=idl-code data-dfn-for=NamedFlowMap/has() data-dfn-type=argument data-export="" data-global-name="NamedFlowMap<interface>/has()<method>/flowname<argument>" id=dom-namedflowmap-has-flowname>flowName<a class=self-link href=#dom-namedflowmap-has-flowname></a></dfn>);
  <a data-link-type=idl href=#dom-namedflowmap title=NamedFlowMap>NamedFlowMap</a> <a class=idl-code data-global-name="NamedFlowMap<interface>/set()<method>" data-link-for=NamedFlowMap data-link-type=method href=#dom-namedflowmap-set title=set()>set</a>(DOMString <dfn class=idl-code data-dfn-for=NamedFlowMap/set() data-dfn-type=argument data-export="" data-global-name="NamedFlowMap<interface>/set()<method>/flowname<argument>" id=dom-namedflowmap-set-flowname>flowName<a class=self-link href=#dom-namedflowmap-set-flowname></a></dfn>, <a data-link-type=idl href=#dom-namedflow title=NamedFlow>NamedFlow</a> <dfn class=idl-code data-dfn-for=NamedFlowMap/set() data-dfn-type=argument data-export="" data-global-name="NamedFlowMap<interface>/set()<method>/flowvalue<argument>" id=dom-namedflowmap-set-flowvalue>flowValue<a class=self-link href=#dom-namedflowmap-set-flowvalue></a></dfn>);
  boolean <a class=idl-code data-global-name="NamedFlowMap<interface>/delete()<method>" data-link-for=NamedFlowMap data-link-type=method href=#dom-namedflowmap-delete title=delete()>delete</a>(DOMString <dfn class=idl-code data-dfn-for=NamedFlowMap/delete() data-dfn-type=argument data-export="" data-global-name="NamedFlowMap<interface>/delete()<method>/flowname<argument>" id=dom-namedflowmap-delete-flowname>flowName<a class=self-link href=#dom-namedflowmap-delete-flowname></a></dfn>);
};
</pre>

<p>The map entries in a
	<a data-link-type=idl href=#dom-namedflowmap title=NamedFlowMap>NamedFlowMap</a> object 
	are the named flow idents
	paired with their 
	<a data-link-type=idl href=#dom-namedflow title=NamedFlow>NamedFlow</a> objects. 
	The <dfn class=idl-code data-dfn-for=NamedFlowMap data-dfn-type=method data-export="" id=dom-namedflowmap-get>get()<a class=self-link href=#dom-namedflowmap-get></a></dfn> 
	and <dfn class=idl-code data-dfn-for=NamedFlowMap data-dfn-type=method data-export="" id=dom-namedflowmap-has>has()<a class=self-link href=#dom-namedflowmap-has></a></dfn> 
	methods return null and false respectively
	if there is no <a data-link-type=idl href=#dom-namedflow title=NamedFlow>NamedFlow</a> 
	with the given ident. 
	The <dfn class=idl-code data-dfn-for=NamedFlowMap data-dfn-type=method data-export="" id=dom-namedflowmap-set>set()<a class=self-link href=#dom-namedflowmap-set></a></dfn> 
	and <dfn class=idl-code data-dfn-for=NamedFlowMap data-dfn-type=method data-export="" id=dom-namedflowmap-delete>delete()<a class=self-link href=#dom-namedflowmap-delete></a></dfn> 
	methods always throw an
	<code>InvalidAccessError</code> exception, 
	as this map is read-only. 
	The <a data-link-type=idl href=#dom-namedflowmap title=NamedFlowMap>NamedFlowMap</a> interface 
	uses the rest of the default map 
	class methods.</p>

<p>The <dfn class=idl-code data-dfn-type=interface data-export="" id=dom-namedflow><code class=idl>NamedFlow</code><a class=self-link href=#dom-namedflow></a></dfn>
	interface offers a representation 
	of a <span class=css>named flow</span> instance.</p>

<p>The <a data-link-type=idl href=#dom-namedflow title=NamedFlow>NamedFlow</a> interface
	can be used for different purposes. 
	For example, the <code>getRegionsByContent()</code> method 
	can help navigate by bookmark: 
	a script can find the <span class=css>CSS Regions</span> 
	that display a particular anchor 
	and bring them to view.</p>

<p>Likewise, the interface allows authors
	to check if all content has been fitted 
	into existing regions. 
	If it has, the <a data-link-type=idl href=#dom-namedflow-overset title=overset>overset</a> attribute 
	would be false.</p>

	<pre class=idl>interface <a class=idl-code data-global-name="" data-link-type=interface href=#dom-namedflow title=NamedFlow>NamedFlow</a> : <a data-link-type=idl href=http://dom.spec.whatwg.org/#eventtarget title=EventTarget>EventTarget</a> {
  readonly attribute DOMString <a class=idl-code data-global-name="NamedFlow<interface>/name<attribute>" data-link-for=NamedFlow data-link-type=attribute data-readonly="" data-type="DOMString " href=#dom-namedflow-name title=name>name</a>;
  readonly attribute boolean <a class=idl-code data-global-name="NamedFlow<interface>/overset<attribute>" data-link-for=NamedFlow data-link-type=attribute data-readonly="" data-type="boolean " href=#dom-namedflow-overset title=overset>overset</a>;
  sequence&lt;<a data-link-type=idl href=#dom-region title=Region>Region</a>&gt; <a class=idl-code data-global-name="NamedFlow<interface>/getregions()<method>" data-link-for=NamedFlow data-link-type=method href=#dom-namedflow-getregions title=getRegions()>getRegions</a>();
  readonly attribute short <a class=idl-code data-global-name="NamedFlow<interface>/firstemptyregionindex<attribute>" data-link-for=NamedFlow data-link-type=attribute data-readonly="" data-type="short " href=#dom-namedflow-firstemptyregionindex title=firstEmptyRegionIndex>firstEmptyRegionIndex</a>;
  sequence&lt;<a data-link-type=idl href=#dom-namedflow-getregionsbycontent-node title=Node>Node</a>&gt; <a class=idl-code data-global-name="NamedFlow<interface>/getcontent()<method>" data-link-for=NamedFlow data-link-type=method href=#dom-namedflow-getcontent title=getContent()>getContent</a>();
  sequence&lt;<a data-link-type=idl href=#dom-region title=Region>Region</a>&gt; <a class=idl-code data-global-name="NamedFlow<interface>/getregionsbycontent()<method>" data-link-for=NamedFlow data-link-type=method href=#dom-namedflow-getregionsbycontent title=getRegionsByContent()>getRegionsByContent</a>(<a data-link-type=idl href=#dom-namedflow-getregionsbycontent-node title=Node>Node</a> <dfn class=idl-code data-dfn-for=NamedFlow/getRegionsByContent() data-dfn-type=argument data-export="" data-global-name="NamedFlow<interface>/getRegionsByContent()<method>/node<argument>" id=dom-namedflow-getregionsbycontent-node>node<a class=self-link href=#dom-namedflow-getregionsbycontent-node></a></dfn>);
};
</pre>

<p>The <dfn class=idl-code data-dfn-for=NamedFlow data-dfn-type=attribute data-export="" id=dom-namedflow-name><code class=idl>name</code><a class=self-link href=#dom-namedflow-name></a></dfn> attribute
	returns the name of the <a data-link-type=idl href=#dom-namedflow title=NamedFlow>NamedFlow</a> instance.</p>

<p>The <dfn class=idl-code data-dfn-for=NamedFlow data-dfn-type=attribute data-export="" id=dom-namedflow-overset><code class=idl>overset</code><a class=self-link href=#dom-namedflow-overset></a></dfn>
	attribute returns true 
	if there are <span class=css>named flow</span> fragments 
	that do not fit 
	in the associated region chain 
	(including the case where 
	there are <span class=css>named flow</span> fragments 
	but no regions in the <span class=css>region chain</span>). 
	Otherwise, it returns false.</p>

<p>The <dfn class=idl-code data-dfn-for=NamedFlow data-dfn-type=method data-export="" id=dom-namedflow-getregions><code class=idl>getRegions()</code><a class=self-link href=#dom-namedflow-getregions></a></dfn>
	method returns the sequence 
	of regions in the <span class=css>region chain</span> 
	associated with the <span class=css>named flow</span>. 
	Note that the returned values 
	is a static sequence 
	in document order.</p>

<p>The <dfn class=idl-code data-dfn-for=NamedFlow data-dfn-type=attribute data-export="" id=dom-namedflow-firstemptyregionindex>firstEmptyRegionIndex<a class=self-link href=#dom-namedflow-firstemptyregionindex></a></dfn>
	is the index of the first region 
	in the region chain with the <code>regionOverset</code> attribute 
	set to <code>empty</code>. 
	If all regions have the <code>regionOverset</code> attribute 
	set to <code>fit</code> or <code>overset</code>, 
	the value for <code>firstEmptyRegionIndex</code> is <code>-1</code>. 
	If there are no regions in the <span class=css>region chain</span>, 
	the value is <code>-1</code> as well.</p>

<p>The <dfn class=idl-code data-dfn-for=NamedFlow data-dfn-type=method data-export="" id=dom-namedflow-getcontent>getContent()<a class=self-link href=#dom-namedflow-getcontent></a></dfn>
	method returns an ordered collection 
	of nodes that constitute the <span class=css>named flow</span>. 
	The returned list is a static snapshot 
	of the <span class=css>named flow</span> content 
	at the time the method is invoked. 
	This list contains the contents	
	that were moved to the <span class=css>named flow</span> 
	by the flow-into property 
	but not any descendants 
	(unless the descendants are themselves 
	moved to the <span class=css>named flow</span>).</p>

<p>The <dfn class=idl-code data-dfn-for=NamedFlow data-dfn-type=method data-export="" id=dom-namedflow-getregionsbycontent>getRegionsByContent()<a class=self-link href=#dom-namedflow-getregionsbycontent></a></dfn>
	method returns the sequence of regions 
	that contain at least part 
	of the target content node 
	if it belongs to the <span class=css>named flow</span> directly 
	or one of its ancestors belongs to the <span class=css>named flow</span>. 
	Otherwise, the method returns 
	an empty sequence. 
	The returned value
	is a static sequence 
	in document order.</p>

<p>The <span class=css>named flow</span> states are :</p>

	<ul>
		<li>
			<code class=idl>NULL</code>: the <span class=css>named flow</span> 
			contains no conent and has no region chain.
		</li>
		<li>
			<code class=idl>CREATED</code>: the <span class=css>named flow</span> 
			either contains content or has a region chain.
		</li>
	</ul>

<p>A <a data-link-type=idl href=#dom-namedflow title=NamedFlow>NamedFlow</a> object is live:
	it always represents the <span class=css>named flow</span> 
	with the corresponding name even if 
	that <span class=css>named flow</span> has transitioned 
	to the <code>NULL</code> state.</p>

<h3 class="heading settled" data-level=4.2 id=the-region-interface><span class=secno>4.2. </span><span class=content>
The Region interface</span><a class=self-link href=#the-region-interface></a></h3>

<p>The <dfn class=idl-code data-dfn-type=interface data-export="" id=dom-region><code class=idl>Region</code><a class=self-link href=#dom-region></a></dfn>
	interface is a 
	<a href=http://www.w3.org/TR/WebIDL/#idl-implements-statements>supplemental interface</a>
	which must be implemented by all objects 
	(<a href=http://www.w3.org/TR/dom/#interface-element>
		<code class=idl>Elements</code></a>, 
	pseudo-elements or other CSS constructs 
	such as <a href=http://dev.w3.org/csswg/css3-page-template/#templates-and-slots>slots</a>) in an implementation which can be <span class=css>CSS Regions</span>.</p>

	<pre class=idl>[NoInterfaceObject]
interface <a class=idl-code data-global-name="" data-link-type=interface href=#dom-region title=Region>Region</a> {
  readonly attribute DOMString <a class=idl-code data-global-name="Region<interface>/regionoverset<attribute>" data-link-for=Region data-link-type=attribute data-readonly="" data-type="DOMString " href=#dom-region-regionoverset title=regionOverset>regionOverset</a>;
  sequence&lt;<a data-link-type=idl href=http://dom.spec.whatwg.org/#range title=Range>Range</a>&gt;? <a class=idl-code data-global-name="Region<interface>/getregionflowranges()<method>" data-link-for=Region data-link-type=method href=#dom-region-getregionflowranges title=getRegionFlowRanges()>getRegionFlowRanges</a>();
};
<a data-link-type=idl href=http://dom.spec.whatwg.org/#element title=Element>Element</a> implements <a data-link-type=idl href=#dom-region title=Region>Region</a>;
</pre>

<p>The <dfn class=idl-code data-dfn-for=Region data-dfn-type=attribute data-export="" id=dom-region-regionoverset><code class=idl>regionOverset</code><a class=self-link href=#dom-region-regionoverset></a></dfn>
	attribute returns one of the following values:</p>

	<dl>
		<dt><span class=css>overset</span></dt>

		<dd>
			The region is the last one in the 
			<span class=css>region chain</span> and 
			not able to fit the remaining content from the <span class=css>named flow</span>.
			Note that the region’s 
			<a href=http://www.w3.org/TR/CSS21/visufx.html#overflow>
				<code class=idl>overflow</code></a> 
			property value can be used to control the 
			visibility of the overflowing content and the 
			<a class=property data-link-type=propdesc href=#propdef-region-fragment title=region-fragment>region-fragment</a> property controls whether or not fragmentation happens 
			on the content that overflows the last region.
		</dd>

		<dt><span class=css>fit</span></dt>

		<dd>
			The region’s flow fragment content 
			fits into the region’s 
			<a href=http://www.w3.org/TR/CSS21/box.html#box-dimensions>content box</a>. 
			If the region is the last one 
			in the <span class=css>region chain</span>, 
			it means that the content 
			fits without overflowing.
			If the region is not the last one 
			in the region chain, 
			that means the <span class=css>named flow</span> content 
			may be further fitted in subsequent regions. 
			In this last case, 
			note that the <span class=css>named flow</span> fragment may be empty 
			(for example if the region is too small 
			to accommodate any content). 
			This value is returned if the <a data-link-type=idl href=#dom-region title=Region>Region</a> object 
			is not (or no longer) a region.
		</dd>

		<dt><span class=css>empty</span></dt>

		<dd>
			All content from the <span class=css>named flow</span> was fitted in prior regions.
		</dd>

	</dl>

<p>If there is no content
	in the <span class=css>named flow</span>, 
	all regions associated 
	with that <span class=css>named flow</span> 
	should have their <a data-link-type=idl href=#dom-region-regionoverset title=regionOverset>regionOverset</a> 
	attribute return <span class=css>empty</span>. 
	If there is content in the flow 
	but that content does not 
	generate any box for visual formatting, 
	the <span class=css>overset</span> attribute on the first region 
	in the region chain associated 
	with the flow will return <span class=css>fit</span>.</p>

<p>The <dfn class=idl-code data-dfn-for=Region data-dfn-type=method data-export="" id=dom-region-getregionflowranges>getRegionFlowRanges()<a class=self-link href=#dom-region-getregionflowranges></a></dfn> method
	returns an array of <a href=http://www.w3.org/TR/dom/#interface-range>Range</a> 
	instances corresponding to fragment 
	from the <span class=css>named flow</span> 
	that is laid out in the region. 
	If the region has not received a fragment 
	because it is too small to accommodate any, 
	the method returns a single <a data-link-type=idl href=http://dom.spec.whatwg.org/#range title=Range>Range</a> 
	where the <code>startContainer</code> 
	and <code>startOffset</code> 
	have the same values as 
	the <code>endContainer</code> 
	and <code>endOffset</code> 
	and therefore the collapsed attribute 
	on the <a data-link-type=idl href=http://dom.spec.whatwg.org/#range title=Range>Range</a> is true. 
	In that situation, 
	if the region is the first 
	in the <span class=css>region chain</span>, 
	the <code>startContainer</code> 
	is the first <code>Node</code> 
	in the <span class=css>named flow</span> 
	and the <code>startOffset</code> is zero. 
	If the region is the last region 
	in the region chain 
	(but not the first and only one), 
	the <code>startContainer</code> 
	and <code>startOffset</code> 
	are the same values as 
	the <code>endContainer</code> 
	and <code>endOffset</code> 
	on the previous region 
	in the <span class=css>region chain</span>. 
	The method returns null 
	if the <span>region</span> object 
	is not (or no longer) a region.</p>

<p>A <a data-link-type=idl href=#dom-region title=Region>Region</a> instance
	may represent an object 
	that is no longer a <span>region</span>. 
	This may happen for example 
	if the <a class=property data-link-type=propdesc href=#propdef-flow-from title=flow-from>flow-from</a> property 
	on the corresponding pseudo-element, 
	element or other construct
	becomes <span class=css>none</span> 
	but a script is still holding 
	a reference to the <a data-link-type=idl href=#dom-region title=Region>Region</a> object.</p>

<h3 class="heading settled" data-level=4.3 id=named-flow-events><span class=secno>4.3. </span><span class=content>
Named flow events</span><a class=self-link href=#named-flow-events></a></h3>

<p><a data-link-type=idl href=#dom-namedflow title=NamedFlow>NamedFlow</a>
	objects are <a href=http://www.w3.org/TR/dom/#interface-eventtarget>EventTargets</a> 
	which dispatch the following events 
	for their respective triggers. 
	These events are asynchronous, 
	and fire at the end of the	
	<a href=#named-flows-layout>regions visual formatting</a> 
	steps.</p>

<p>The regionfragmentchange event is dispatched
	on any change to a named flow’s fragmentation through its region chain, 
	including changes to any overset fragment.</p>

	<table class=event-desc style="border: 1px solid gray">
		<tbody>
			<tr class="assert must"><th>Type</th>
				<td class=eventname><strong><code>regionfragmentchange</code></strong></td>
			</tr>
			<tr class="assert must"><th>Interface</th> 
				<td><code><a href=http://www.w3.org/TR/DOM-Level-3-Events/#events-uievents>UIEvent</a></code> (see <a data-biblio-type=normative data-link-type=biblio href=#biblio-dom-level-3-events title=DOM-LEVEL-3-EVENTS>[DOM-LEVEL-3-EVENTS]</a>)</td>
			</tr>
			<tr class="assert must"><th>Sync / Async</th> <td>Async</tr>
			<tr class="assert must"><th>Bubbles</th> <td>No</tr>
			<tr class="assert must"><th>Target</th> 
				<td><a data-link-type=idl href=#dom-namedflow title=NamedFlow>NamedFlow</a></td>
			</tr>
			<tr class="assert must"><th>Cancelable</th> <td>Yes</tr>
			<tr class="assert must"><th>Default action</th> <td>none</tr>
			<tr class="assert must"><th>Context info</th>
				<td>
					<ul>
						<li><code class=attribute-name>Event.target</code>: 
							<a data-link-type=idl href=#dom-namedflow title=NamedFlow>NamedFlow</a> whose fragmentation has changed.
						</li>
					</ul>
				</td>
			</tr>
		</tbody>
	</table>


<p>The regionoversetchange event is dispatched
	if any of the regionOverset values change 
	in a named flow’s region chain, 
	including when regions are added or removed from the chain.</p>

	<table class=event-desc style="border: 1px solid gray">
		<tbody>
			<tr class="assert must"><th>Type</th>
				<td class=eventname><strong><code>regionoversetchange</code></strong></td>
			</tr>
			<tr class="assert must"><th>Interface</th> 
				<td><code><a href=http://www.w3.org/TR/DOM-Level-3-Events/#events-uievents>UIEvent</a></code> (see <a data-biblio-type=normative data-link-type=biblio href=#biblio-dom-level-3-events title=DOM-LEVEL-3-EVENTS>[DOM-LEVEL-3-EVENTS]</a>)</td>
			</tr>
			<tr class="assert must"><th>Sync / Async</th> <td>Async</tr>
			<tr class="assert must"><th>Bubbles</th> <td>No</tr>
			<tr class="assert must"><th>Target</th> 
				<td><a data-link-type=idl href=#dom-namedflow title=NamedFlow>NamedFlow</a></td>
			</tr>
			<tr class="assert must"><th>Cancelable</th> <td>Yes</tr>
			<tr class="assert must"><th>Default action</th> <td>none</tr>
			<tr class="assert must"><th>Context info</th>
				<td>
					<ul>
						<li><code class=attribute-name>Event.target</code>: 
							<a data-link-type=idl href=#dom-namedflow title=NamedFlow>NamedFlow</a> whose region chain has regionOverset values that have changed.
						</li>
					</ul>
				</td>
			</tr>
		</tbody>
	</table>

<h3 class="heading settled" data-level=4.4 id=cssomview-and-regions><span class=secno>4.4. </span><span class=content>
Clarifications on pre-existing APIs</span><a class=self-link href=#cssomview-and-regions></a></h3>

<h4 class="heading settled" data-level=4.4.1 id=cssomview-getclientrects-and-getboundingclientrect><span class=secno>4.4.1. </span><span class=content>
<code class=idl>getClientRects()</code> and <code>getBoundingClientRect()</code></span><a class=self-link href=#cssomview-getclientrects-and-getboundingclientrect></a></h4>

<p>The <a href=http://www.w3.org/TR/cssom-view/>CSSOM View Module</a>
	defines how user agents compute 
	the bounding client rectangle 
	for an element (<code class=idl>getBoundingClientRect()</code>) 
	and its generated boxes (<code class=idl>getClientRects()</code>).</p>

<p>This definition applies to
	the (possibly) multiple boxes 
	generated for an element in a named flow 
	flowing through a region chain. 
	The <code class=idl>getClientRects()</code> method 
	returns the list of boxes generated 
	for each of the element fragments 
	laid out in different regions. 
	The <code>getBoundingClientRect()</code> method 
	operates as specified in the 
	<a href=http://www.w3.org/TR/cssom-view/>CSSOM View Module</a> 
	as well and is computed 
	from the set of rectangles 
	returned by <code class=idl>getClientRects()</code>.</p>

<h4 class="heading settled" data-level=4.4.2 id=cssomview-offset-attributes><span class=secno>4.4.2. </span><span class=content>
<code class=idl>offsetTop</code>, <code class=idl>offsetLeft</code>,
<code class=idl>offsetWidth</code>, <code class=idl>offsetHeight</code> and <code class=idl>offsetParent</code></span><a class=self-link href=#cssomview-offset-attributes></a></h4>

<p>The computation of the
	<a href=http://dev.w3.org/csswg/cssom-view/#extensions-to-the-htmlelement-interface>offset attributes</a> 
	for elements laid out in a <span class=css>named flow</span> follow the 
	<a href=http://dev.w3.org/csswg/cssom-view/#extensions-to-the-htmlelement-interface>specification</a> 
	<a data-biblio-type=normative data-link-type=biblio href=#biblio-cssom title=CSSOM>[CSSOM]</a>. 
	For the purpose of these algorithms, 
	the <em>first CSS layout box</em> associated 
	with an element laid out in a <span class=css>named flow</span> 
	is the first box generated for the first region the element is laid out into. 
	In the offsetParent algorithm, 
	the nearest ancestor search skips 
	from the topmost named flow elements directly to the body element.</p>

<h2 class="heading settled" data-level=5 id=multi-column-regions><span class=secno>5. </span><span class=content>
Multi-column regions</span><a class=self-link href=#multi-column-regions></a></h2>

<p>A
	<a href=http://dev.w3.org/csswg/css3-multicol/#multi-column-element>multi-column</a> 
	<a data-biblio-type=informative data-link-type=biblio href=#biblio-css3col title=CSS3COL>[CSS3COL]</a>
	element can be 
	assigned to a <span class=css>region chain</span>. 
	The element becomes part 
	of the region chain 
	for the associated <span class=css>named flow</span>, 
	and flows its content fragments 
	through columns according to 
	the multi-column specification 
	<a data-biblio-type=normative data-link-type=biblio href=#biblio-css3col title=CSS3COL>[CSS3COL]</a>. 
	In particular, 
	when computing the 
	<a href=#rfcb-flow-fragment-height-resolution>flow fragment height</a> 
	of a multi-column element 
	that is associated with a <em><span class=css>named flow</span></em>, 
	the <a class=property data-link-type=propdesc href=http://www.w3.org/TR/css3-multicol/#column-fill title=column-fill>column-fill</a>
	<a data-biblio-type=normative data-link-type=biblio href=#biblio-css3col title=CSS3COL>[CSS3COL]</a>
	property is honored 
	to balance the fragments of content 
	that would flow through 
	its columns.</p>

<p>Overflow of multicol regions
	is mostly handled 
	according to the same rules 
	as other <span class=css>CSS Regions</span>. 
	If the remainder of the named flow 
	does not fit 
	in the multicol region, 
	then the rest 
	of the content flows into 
	the remaining region chain. 
	However, 
	if a multicol region 
	is the last region 
	in a <span class=css>region chain</span>, 
	then the multicol region must follow the 
	<a href=http://dev.w3.org/csswg/css3-multicol/#overflow-columns>overflow column rules</a> 
	<a data-biblio-type=normative data-link-type=biblio href=#biblio-css3col title=CSS3COL>[CSS3COL]</a>.</p>

	<div class=example>

<p>The following example:</p>

		<pre>&lt;style&gt;
  article {
      flow-into: article-flow;
  }
  #multi-col {
      column-count: 2;
      flow-from: article;
      height: 6em;
      column-gap: 1em; 
  }
  #remainder {
      flow-from: article;
      height: auto;
  }
&lt;/style&gt;
&lt;body&gt;
  &lt;article&gt;...&lt;/article&gt;
  &lt;div id="multicol"&gt;&lt;/div&gt;
  &lt;div id="remainder"&gt;&lt;/div&gt;
&lt;/body&gt;
</pre>

<p>is equivalent in rendering to, for example:</p>

		<pre>&lt;style&gt;
  article {
      flow-into: article-flow;
  }
  #flex {
      display: flex;
      flex-pack: justify;
      height: 6em;
  }
  #flex &gt; div {
      flow-from: article;
      width: calc(50% - 0.5em);
  }
  #remainder {
      flow-from: article;
      height: auto;
  }
&lt;/style&gt;
&lt;body&gt;
  &lt;article&gt;...&lt;/article&gt;
  &lt;div id="flex"&gt;
    &lt;div /&gt;
    &lt;div /&gt;
  &lt;/div&gt;
  &lt;div id="remainder"&gt;&lt;/div&gt;
&lt;/body&gt;
</pre>
	</div>

<h2 class="heading settled" data-level=6 id=pseudo_elements><span class=secno>6. </span><span class=content>
Pseudo-elements</span><a class=self-link href=#pseudo_elements></a></h2>

<p>It can be useful
	to visually mark the content 
	to highlight that a content thread 
	is flowing through the region chain. 
	For example, a marker 
	such as <em>'continued below'</em> clearly indicates, 
	at the end of a <span class=css>CSS Region</span>, 
	that there is more content in the flow 
	which can be found by scrolling past 
	whatever content interrupts the region chain.</p>

<p>The '::before' and '::after' pseudo-elements (see <a data-biblio-type=normative data-link-type=biblio href=#biblio-select title=SELECT>[SELECT]</a>)
	let content authors mark the beginning 
	and end of a region with such markers.</p>

<h2 class="heading settled" data-level=7 id=regions-visual-formatting-details><span class=secno>7. </span><span class=content>
Regions visual formatting details</span><a class=self-link href=#regions-visual-formatting-details></a></h2>

<p>Regions are laid out by CSS and take part in the normal box model and other layout models
	offered by CSS modules such as flexible boxes (<a data-biblio-type=informative data-link-type=biblio href=#biblio-css3-flexbox title=CSS3-FLEXBOX>[CSS3-FLEXBOX]</a>). However, <span>regions</span>
	lay out a fragment of their <span class=css>named flow</span> instead of laying out descendant content as happens with other 
	boxes.</p>

<p>This section describes the model for laying out <span>regions</span>
	and for laying out <span class=css>named flow</span> content into regions. 
	The descriptions in this section are biased towards a horizontal writing mode, 
	using <span class=css>width</span> for logical width (or measure) 
	and <span class=css>height</span> for logical height (or extent) 
	as <a href=http://www.w3.org/TR/css3-writing-modes/#abstract-dimensions>defined</a> 
	in the CSS Writing Modes Module <a data-biblio-type=normative data-link-type=biblio href=#biblio-css3-writing-modes title=CSS3-WRITING-MODES>[CSS3-WRITING-MODES]</a>). 
	To use this model in a vertical writing mode apply the principles 
	<a href=http://www.w3.org/TR/css3-writing-modes/#vertical-layout>described</a> 
	in that specification.</p>

<h3 class="heading settled" data-level=7.1 id=processing-model><span class=secno>7.1. </span><span class=content>
Processing model</span><a class=self-link href=#processing-model></a></h3>

<p>The '::before' content is laid out
	in the region prior to 
	any other content coming from the flow.</p>

<p>The '::after' content is laid out
	in the region after laying out 
	the flow fragment content into the <span>RFCB</span>. 
	Then, flow content is removed from the fragment 
	to accommodate the '::after' content. 
	Accommodating means that the '::after' content 
	is laid out without overflowing the region.</p>

<p>If there is not enough room to accommodate
	the ::before content, 
	the '::after' content after removing all flow fragment content, 
	or a combination of the two, 
	then the ::before and/or ::after content overflows that region.</p>

<h3 class="heading settled" data-level=7.2 id=regions-flow-content-box><span class=secno>7.2. </span><span class=content>
The Region Flow Content Box (RFCB)</span><a class=self-link href=#regions-flow-content-box></a></h3>

<p>A region box lays out the following boxes:</p>

	<ul>
		<li>
			The boxes generated by its <code>::before</code> and 
			<code>::after</code> pseudo-elements, if any.
		</li>
		<li>
			The anonymous <dfn data-dfn-type=dfn data-noexport="" id=region-flow-content-box>region flow content box<a class=self-link href=#region-flow-content-box></a></dfn> 
			(called <dfn data-dfn-type=dfn data-noexport="" id=rfcb>RFCB<a class=self-link href=#rfcb></a></dfn> in this document) 
			which contains the fragment of the <span class=css>named flow</span> 
			that the region receives.
		</li>
	</ul>

	<figure>
		<img alt="The ::before, RFCB and ::after boxes contained in the Region Box" src=images/RFCB.svg width=600>
		<figcaption>
			The Region Flow Content Box (RFCB)
		</figcaption>
	</figure>

<p>Laying out a <span>region</span> box follows the same processing rules
	as for any other <a href=http://www.w3.org/TR/CSS2/visuren.html#block-boxes>block container box</a>.</p>

<p>The <span>RFCB</span> is a
	<a href=http://www.w3.org/TR/CSS21/visuren.html#block-boxes>block container box</a> 
	with a computed <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-width title=width>width</a> of <span class=css>auto</span> and whose used <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-height title=height>height</a> is resolved as detailed below.</p>

<p>Since the <span>RFCB</span> is a <a href=http://www.w3.org/TR/CSS21/visuren.html#block-boxes>block container box</a>, the ::before box and ::after box will also be block containers, though the contents of ::before and ::after may be inline within those boxes.</p>

<h4 class="heading settled" data-level=7.2.1 id=rfcb-width-resolution><span class=secno>7.2.1. </span><span class=content>
RFCB <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-width title=width>width</a> resolution</span><a class=self-link href=#rfcb-width-resolution></a></h4>

<p>At various points in the visual formatting of documents containing regions,
	the used <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-width title=width>width</a> of RFCBs and regions need to be resolved. 
	In all cases, the resolution is done following the rules for 
	<a href=http://www.w3.org/TR/CSS2/visudet.html#Computing_widths_and_margins>calculating widths and margins</a> (see <a data-biblio-type=normative data-link-type=biblio href=#biblio-css21 title=CSS21>[CSS21]</a>). 
	Sometimes, resolving the used <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-width title=width>width</a> value requires 
	measuring the content’s <code>min-content</code> 
	and <code>max-content</code> values 
	(as <a href=http://www.w3.org/TR/css3-writing-modes/#orthogonal-auto>defined</a> 
	in the CSS Writing Modes Module <a data-biblio-type=normative data-link-type=biblio href=#biblio-css3-writing-modes title=CSS3-WRITING-MODES>[CSS3-WRITING-MODES]</a>). 
	or an RFCB, <strong>these measures are made 
	on the <em>entire</em> associated <span class=css>named flow</span> content</strong>.</p>

<p>As a consequence,
	all <span>RFCBs</span> of <span>regions</span> associated 
	with a given <span class=css>named flow</span> 
	share the same <code>min-content</code> 
	and <code>max-content</code> measures.</p>

<p>This approach is consistent with the
	<a href=http://www.w3.org/TR/css3-break/#varying-size-boxes>box model for breaking</a> (<a data-biblio-type=normative data-link-type=biblio href=#biblio-css3-break title=CSS3-BREAK>[CSS3-BREAK]</a>).</p>


<h3 class="heading settled" data-level=7.3 id=regions-visual-formatting-steps><span class=secno>7.3. </span><span class=content>
Regions visual formatting steps</span><a class=self-link href=#regions-visual-formatting-steps></a></h3>

<p>Formatting documents that contain <span class=css>named flows</span> laid out in regions
	is a three-step process:</p>

	<ul>
		<li>
			<em>Step 1: RFCB <dfn data-dfn-type=dfn data-noexport="" id=flow-fragment-height>flow fragment height<a class=self-link href=#flow-fragment-height></a></dfn> resolution</em>. 
			In this step, the heights of fragments fitting in the regions' RFCBs are resolved.
		</li>
		<li>
			<em>Step 2: document and regions layout</em>. 
			In this step, the document content and regions are laid out. 
			However, <span class=css>named flow</span> content is not laid out in regions yet.
		</li>
		<li>
			<em>Step 3: <span class=css>named flow</span> layout</em>. 
			In this step, the content of <span class=css>named flows</span> 
			is laid out in their respective <span class=css>region chains</span>.
		</li>
	</ul>

	<figure>
		<img alt="visual representation of the three-step process" src=images/regions-layout-three-steps.svg width=600>
		<figcaption>
			Regions visual formatting steps
		</figcaption>
	</figure>

<h4 class="heading settled" data-level=7.3.1 id=rfcb-flow-fragment-height-resolution><span class=secno>7.3.1. </span><span class=content>
Step 1: RFCB flow fragment height resolution</span><a class=self-link href=#rfcb-flow-fragment-height-resolution></a></h4>

<p>Conceptually, resolving the flow fragment height is a two phase process.</p>

<h5 class="heading settled" data-level=7.3.1.1 id=rfcb-flow-fragment-height-resolution-phase-1><span class=secno>7.3.1.1. </span><span class=content>
RFCB flow fragment height resolution, Phase 1</span><a class=self-link href=#rfcb-flow-fragment-height-resolution-phase-1></a></h5>

<p>The document is laid out with a
	<a href=http://www.w3.org/TR/CSS2/cascade.html#used-value>used</a> height of zero
	for all <span>RFCB</span>s. In this phase, the content of <span class=css>named flows</span> is not laid out in 
	<span>regions</span>. This phase yields resolved position and sizes for all regions and
	their RFCBs in the document.</p>

<h5 class="heading settled" data-level=7.3.1.2 id=rfcb-flow-fragment-height-resolution-phase-2><span class=secno>7.3.1.2. </span><span class=content>
RFCB flow fragment height resolution, Phase 2</span><a class=self-link href=#rfcb-flow-fragment-height-resolution-phase-2></a></h5>

<p><span class=css>named flows</span> are laid out in <span>regions</span>.
	The user agent resolves 
	the <em><span>flow fragment height</span></em> 
	for the <span>RFCB</span>s 
	using the remainder of the flow 
	and accounting for <a href=http://www.w3.org/TR/css3-break/>fragmentation rules</a>. 
	This process accounts for constraints 
	such as the <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-height title=height>height</a> or <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-max-height title=max-height>max-height</a> values, 
	as described in the CSS 2.1 section 
	on <a href=http://www.w3.org/TR/CSS2/visudet.html#Computing_heights_and_margins>calculating heights and margins</a> 
	(see the <a href=http://www.w3.org/TR/CSS2/visudet.html#normal-block>Block-level non-replaced elements in normal flow...</a> 
	section and the <a href=http://www.w3.org/TR/CSS2/visudet.html#block-root-margin>complicated cases</a> section). 
	During this phase, 
	generated content is laid out 
	according to the <a href=#processing-model>rules</a> 
	described earlier in this document.</p>

<p>In a <span class=css>nested region context</span>,
	this phase will trigger 
	the beginning of Step 1 
	for any inner <span class=css>named flows</span> 
	whose regions are contained 
	in the outer <span class=css>named flow</span>. 
	All of Step 1 for inner flows 
	must recursively complete before Step 1 
	for an outer flow completes.</p>

<h4 class="heading settled" data-level=7.3.2 id=regions-boxes-layout><span class=secno>7.3.2. </span><span class=content>
Step 2: region boxes layout</span><a class=self-link href=#regions-boxes-layout></a></h4>

<p>In this step, the document is laid out according to the normal CSS layout rules.</p>

<p>If a measure of the content is required to resolve the used <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-width title=width>width</a> of the region box,
	the value is resolved as described in the 
	<a href=#rfcb-width-resolution>RFCB width resolution</a> section.</p>

<p>If a measure of the content is required to resolve the used height of the RFCB
	(for example if the region box is absolutely positioned), 
	the <span>flow fragment height</span> resolved in Step 1 is used 
	for the vertical content measure of the RFCB.</p>

<p>At the end of this step,
	regions are laid out and ready to receive content 
	from their associated <span class=css>named flows</span>.</p>

<h4 class="heading settled" data-level=7.3.3 id=named-flows-layout><span class=secno>7.3.3. </span><span class=content>
Step 3: named flows layout</span><a class=self-link href=#named-flows-layout></a></h4>

<p>In this final step,
	the content of <span class=css>named flows</span> 
	is laid out in the <span>regions</span>' RFCBs 
	along with the generated content boxes.</p>

<p>The used <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-width title=width>width</a> for RFCBs is resolved
	<a href=#rfcb-width-resolution>as described before</a>.</p>

<p>The used <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-height title=height>height</a> of RFCBs is resolved
	such that none of the boxes 
	in the region box’s normal flow 
	overflow the region’s box. 
	In other words, 
	the RFCB boxes are stretched vertically 
	to accommodate as much 
	of the flow as possible 
	without overflowing the region box 
	and accounting for 
	<a href=http://www.w3.org/TR/css3-break/>fragmentation rules</a> 
	and generated content boxes.</p>

<p>During this phase,
	generated content is laid out 
	according to the <a href=#processing-model>rules</a> 
	described earlier in this document.</p>

<p>In a <span class=css>nested region context</span>,
	this step will trigger Step 2
	for inner <span class=css>named flows</span> 
	whose regions are contained 
	in the outer <span class=css>named flow</span>. 
	Fragmentation of the inner regions 
	may result as they are laid out 
	in the outer region chain.
	Once Step 3 for an outer named flow is complete, 
	Step 3 for the inner named flows recursively begins.</p>

<p>Once Step 3 for a named flow is complete,
	The conditions for the 
	<a href=#named-flow-events>named flow events</a> are checked, 
	and if the triggers are met 
	the events dispatch at this point.</p>

	<div class=note><span class=note-prefix>Note </span>

<p>The model for resolving auto sized regions will cause,
		under certain circumstances, 
		the flow content to be overset or underset. 
		In other words, 
		it will not fit tightly. 
		The model prevents having circular dependencies 
		in the layout model. 
		Implementations may decide to apply 
		further layout steps 
		to ensure that the whole flow content 
		is displayed to the user, 
		even in edge cases.</p>
	</div>

<h3 class="heading settled" data-level=7.4 id=regions-visual-formatting-implementation-note><span class=secno>7.4. </span><span class=content>
Regions visual formatting: implementation note</span><a class=self-link href=#regions-visual-formatting-implementation-note></a></h3>

<p>The process for resolving an RFCB’s <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-height title=height>height</a> and the three-step process used to
	lay out documents containing regions and <span class=css>named flows</span> are
	<em>conceptual</em> descriptions of what the layout 
	should yield and implementations should optimize to reduce the number of
	steps and phases necessary wherever possible.</p>

<h3 class="heading settled" data-level=7.5 id=regions-visual-formatting-examples><span class=secno>7.5. </span><span class=content>
Regions visual formatting example</span><a class=self-link href=#regions-visual-formatting-examples></a></h3>

<p>This section is non-normative.</p>

<p>This example considers a document where content flows between three regions,
	and region boxes are intermixed with the normal document content.</p>

	<div class=example>
		<pre>&lt;style&gt;
  article {
      flow-into: article;
  }
  #rA, #rB, #rC {
      flow-from: article;
      height: auto;
      margin: 1em 1em 0em 1em;
      padding: 1em;
      border: 3px solid #46A4E9;
  }
  #rA {
      width: auto;
  }
  #rB {
      float: left;
      width: 15em;
      max-height: 150px;
  }
  #rC {
      float: right;
      width: 12em;
  }
  #main-flow {
      padding: 0em 1em 0em 1em;
  }
&lt;/style&gt;
&lt;body&gt;
    &lt;article&gt;
        &lt;p style="break-after:region;"&gt;I am not a ... &lt;/p&gt;
        &lt;p&gt;...&lt;/p&gt;
    &lt;/article&gt;
    &lt;div id="rA"&gt;&lt;/div&gt;
    &lt;div id="rB"&gt;&lt;/div&gt;
    &lt;div id="rC"&gt;&lt;/div&gt;
    &lt;div id="main-flow"&gt;
        &lt;p&gt;Lorem ipsum dolor ...&lt;/p&gt;
    &lt;/div&gt;
&lt;/body&gt;
</pre>
	</div>

<p>The following sections and figures illustrate the intermediate results
	for the visual formatting process. 
	In the following, we call RFCB-A, RFCB-B and RFCB-C 
	the <span>RFCBs</span> for regions rA, rB and rC respectively.</p>

<h4 class="heading settled" data-level=7.5.1 id=step1-phase1-example><span class=secno>7.5.1. </span><span class=content>
Step 1 - Phase 1: Laying out RFCBs with used height of zero</span><a class=self-link href=#step1-phase1-example></a></h4>

<p>Applying the rules for Step 1, Phase 1,
	the computed <span class=css>auto</span> <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-width title=width>width</a> values for the RFCBs are resolved 
	to used values according to the normal 
	<a href=http://www.w3.org/TR/CSS2/visudet.html#Computing_widths_and_margins>CSS layout rules</a> 
	meaning they stretch to the width 
	of their containing block’s content box.</p>

	<ol>
		<li>RFCB-A: stretches to fit the rA content box.
			<p>Since rA also has an <span class=css>auto</span> <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-width title=width>width</a>, its own used <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-width title=width>width</a> is stretched to fit the 
			<code>&lt;body&gt;</code> content box.</p>
		</li>
		<li>RFCB-B: stretches to fit the <code>rB</code> content box.</li>
		<li>RFCB-C: stretches to fit the <code>rC</code> content box.</li>
	</ol>

<p>Also applying the rules for Step 1, Phase 1,
	the used values for the RFCBs <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-height title=height>height</a> properties are all zero.</p>

<p>Conceptually, this produces the layout illustrated below.</p>

	<figure>
		<img alt="Step 1 - Phase 1: Layout RFCBs with used heights of 0" src=images/flow-fragment-height-phase-1.png width=500>
		<figcaption>
			Step 1 - Phase 1: Layout RFCBs with used heights of 0
		</figcaption>
	</figure>

<h4 class="heading settled" data-level=7.5.2 id=step1-phase2-example><span class=secno>7.5.2. </span><span class=content>
Step 1 - Phase 2: Layout flow to compute the RFCBs' flow fragments heights</span><a class=self-link href=#step1-phase2-example></a></h4>

<p>In this second phase of Step 1,
	the named flow is laid out in <span>regions</span> 
	and the height of each fragment falling in each RFCB is computed.</p>

<p>The user agent lays out as much
	of the flow into an area with RFCB-A’s used <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-width title=width>width</a>. 
	rA’s <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-height title=height>height</a> computes to <span class=css>auto</span> 
	and there is no vertical maximum height for RFCA’s <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-height title=height>height</a>. 
	However, because there is a break after the first paragraph 
	in the "article" <code>named flow</code>,
	only this first paragraph is laid out 
	in RFCB-A and FH-A (the flow fragment height for RFCB-A) 
	is resolved by laying out this first paragraph in the used <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-width title=width>width</a>.</p>

<p>At this point, the user agent lays out as much
	of the remaining flow as possible in RFCB-B. 
	Because rB’s <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-max-height title=max-height>max-height</a> computed value is "150px", 
	the user agent only lays out the "article" named flow 
	using RFCB-B’s used <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-width title=width>width</a> until the point where 
	laying out additional content would cause RFCB-B to overflow rB’s box. 
	The fragment height for RFCB-B is resolved: FH-B (<code>150px</code>).</p>

<p>Finally, the user agent lays out the remainder of the flow in RFCB-C.
	Because rC has no other constraints and no region breaks, 
	the remaining content is laid out in RFCB-C’s used <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-width title=width>width</a>. 
	This results in a resolved flow fragment height: FH-C.</p>

	<figure>
		<img alt="Step 1 - Phase 2: Measure flow fragments heights" src=images/flow-fragment-height-phase-2.png width=370>
		<figcaption>
			Step 1 - Phase 2: Measure flow fragments heights
		</figcaption>
	</figure>

<h4 class="heading settled" data-level=7.5.3 id=step2-example><span class=secno>7.5.3. </span><span class=content>
Step 2: Layout document and regions without named flows</span><a class=self-link href=#step2-example></a></h4>

<p>The used <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-width title=width>width</a> of RFCB-A, RFCB-B and RFCB-C
	are resolved as in the previous step. 
	However, the <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-height title=height>height</a> is resolved differently.</p>

<p>Resolving the <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-height title=height>height</a> of rA
	<a href=http://www.w3.org/TR/CSS2/visudet.html#normal-block>requires a content measure</a> 
	which is FH-A (the flow fragment height for RFCB-A).</p>

<p>The <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-height title=height>height</a> of rB results from first computing its
	<a href=http://www.w3.org/TR/CSS2/visudet.html#block-root-margin>content measure</a> 
	and then applying the 
	<a href=http://www.w3.org/TR/CSS2/visudet.html#min-max-heights>rules for max-height</a>. 
	Here, the vertical content measure evaluates to FH-B. 
	After applying the rules for <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-max-height title=max-height>max-height</a> 
	and accounting for margins, padding and borders, 
	the used <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-height title=height>height</a> of rB is resolved to LH-B 
	(<code>150px</code>).</p>

<p>The <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-height title=height>height</a> of rC’s box results from
	<a href=http://www.w3.org/TR/CSS2/visudet.html#block-root-margin>calculating its content measure</a>: 
	FH-C becomes rC’s used <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-height title=height>height</a>.</p>

	<figure>
		<img alt="Step 2: Layout document and regions without named flows" src=images/regions-visual-formatting-step-2.png width=370>
		<figcaption>
			Step 2: Layout document and regions without <span class=css>named flows</span>
		</figcaption>
	</figure>

<h4 class="heading settled" data-level=7.5.4 id=step3-example><span class=secno>7.5.4. </span><span class=content>
Step 3: named flows layout</span><a class=self-link href=#step3-example></a></h4>

<p>In this final step,
	the <code>article</code> <span class=css>named flow</span> 
	is laid out in its <span class=css>region chain</span>. 
	The used <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-width title=width>width</a> for each of the RFCB 
	is resolved as in step 1 above.</p>

<p>The used <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-height title=height>height</a> for the RFCB is a result
	of laying out the as much of the content 
	in the <span>region</span> without overflowing its content box 
	and following the <a href=http://www.w3.org/TR/css3-break/>fragmentation rules</a>.</p>

<p>Because the computed <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-width title=width>width</a> of the RFCB has not changed
	and the fragmentation rules applied are the same as in Phase 1, Step 2, 
	the used <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-height title=height>height</a> for RFCB-A, RFCB-B and RFCB-C 
	are LH-A, LH-B and LH-C, respectively.</p>

<p>There may be situations where the used <a class=property data-link-type=propdesc href=http://www.w3.org/TR/CSS21/visudet.html#propdef-height title=height>height</a>
	of RFCBs resolved in Step 3 are different 
	from the <span>flow fragment height</span> 
	computed in Step 1 Phase 2.</p>

	<figure>
		<img alt="Step 3: Final result after laying out named flows in regions" src=images/regions-visual-formatting-step-3.png width=370>
		<figcaption>
			Step 3: Final result after laying out named flows in regions
		</figcaption>
	</figure>

<h2 class="heading settled" data-level=8 id=relation-to-document-events><span class=secno>8. </span><span class=content>
Relation to document events</span><a class=self-link href=#relation-to-document-events></a></h2>

<p>The CSS Regions module does not alter
	the normal processing of events 
	in the document tree. 
	In particular, 
	if an event occurs on an element 
	that is part of a <span class=css>named flow</span>, 
	the <a href=http://www.w3.org/TR/dom/#events>event’s bubble and capture phases</a> 
	happen following the document tree order.</p>

	<div class=note><span class=note-prefix>Note </span>

<p>This means that in most cases
		<span class=css>CSS Regions</span> 
		will not receive user events
		that trigger on their named flow content. 
		Event handlers for named flow content can check 
		<code><a href=http://dev.w3.org/csswg/cssom-view/#extensions-to-the-document-interface>getElementsFromPoint()</a></code> <a data-biblio-type=informative data-link-type=biblio href=#biblio-cssom-view title=CSSOM-VIEW>[CSSOM-VIEW]</a> 
		to find the <span class=css>CSS Region</span> 
		where the user event occurred. 
		Future versions of CSS-UI may provide 
		a more general solution for user event bubbling 
		where the stack of elements 
		at the event coordinates</p>

	</div>

<h2 class="heading settled" data-level=9 id=relation-to-other-specifications><span class=secno>9. </span><span class=content>
Relation to other specifications</span><a class=self-link href=#relation-to-other-specifications></a></h2>

<p>This specification is related to other specifications
	as described in the references section. 
	In addition, it is related to the following specifications:</p>

	<ol>
		<li>
			CSS Fragmentation Module Level 3 <a data-biblio-type=informative data-link-type=biblio href=#biblio-css3-break title=CSS3-BREAK>[CSS3-BREAK]</a>. 
			This module defines the rules for fragmenting content over multiple containers 
			and applies to <span class=css>CSS Regions</span> 
			in addition to applying to multi-column and paged media.
		</li>

		<li>
			CSS Pagination Templates Module Level 3 <a data-biblio-type=informative data-link-type=biblio href=#biblio-css3-page-template title=CSS3-PAGE-TEMPLATE>[CSS3-PAGE-TEMPLATE]</a>. 
			This module defines a syntax to define layout templates 
			which can be used when paginating content. 
			The page templates use regions.
		</li>

		<li>
			CSS Exclusions Module <a data-biblio-type=informative data-link-type=biblio href=#biblio-css3-exclusions title=CSS3-EXCLUSIONS>[CSS3-EXCLUSIONS]</a>. 
			This module defines a generic way to define exclusions 
			around which content can flow. 
			This can be seen as an extension to CSS floats. 
			In advanced layout designs, 
			it is expected that the CSS Exclusions module 
			will be commonly combined with the CSS Regions module.
		</li>

		<li>
			CSS Line Grid Module <a data-biblio-type=informative data-link-type=biblio href=#biblio-css3-line-grid title=CSS3-LINE-GRID>[CSS3-LINE-GRID]</a>. 
			This module defines a concept of line grid 
			to align the position of lines in different elements. 
			The line grid functionality is related and needed 
			for aligning content flowing in separate regions.
		</li>
	</ol>

<h2 class="heading settled" data-level=10 id=usecases><span class=secno>10. </span><span class=content>
Use Cases</span><a class=self-link href=#usecases></a></h2>

<p>Use cases are described on
	<a href=http://wiki.csswg.org/spec/css3-regions/regions-use-cases>these</a> 
	<a href=http://wiki.csswg.org/spec/css3-regions/regions-print-use-cases>pages</a>.</p>

<h2 class="heading settled" data-level=11 id=changes><span class=secno>11. </span><span class=content>
Changes</span><a class=self-link href=#changes></a></h2>

<h3 class="heading settled" data-level=11.1 id=changes_from_Feb_18_2014><span class=secno>11.1. </span><span class=content>
Changes from <a href=http://www.w3.org/TR/2014/WD-css3-regions-20140218/>February 18<sup>th</sup> 2014</a> version</span><a class=self-link href=#changes_from_Feb_18_2014></a></h3>

	<ul>
		<li>Added three simpler examples to the introduction</li>
		<li>Moved complex example to the <a href=http://wiki.csswg.org/spec/css3-regions/complex-layout-example>CSSWG wiki</a></li>
	</ul>

<h3 class="heading settled" data-level=11.2 id=changes_from_May_28_2013><span class=secno>11.2. </span><span class=content>
Changes from <a href=http://www.w3.org/TR/2013/WD-css3-regions-20130528/>May 28<sup>th</sup> 2013</a> version</span><a class=self-link href=#changes_from_May_28_2013></a></h3>

	<ul>
		<li>Removed region styling from this level</li>
		<li>Changed ::region() to ::region</li>
		<li>display:none elements do not become CSS Regions</li>
		<li>Clarify accessibility interactions with flow-into</li> 
		<li>Change NamedFlowCollection to NamedFlowMap</li>
		<li>Remove mention of run-in and clarify ::before and ::after block containers</li>
		<li>Removed custom element syntax from examples</li>
		<li>Changed NamedFlowCollection getters back to null when there is no NamedFlow.</li>
		<li>Removed issue on user events and added note describing solution(s)</li>
		<li>Changed type of NamedFlow.getContent() from NodeList to sequence&lt;Node&gt;</li>
	</ul>

<h3 class="heading settled" data-level=11.3 id=changes_from_Aug_28_2012><span class=secno>11.3. </span><span class=content>
Changes from <a href=http://www.w3.org/TR/2012/WD-css3-regions-20120823/>August 28<sup>th</sup> 2012</a> version</span><a class=self-link href=#changes_from_Aug_28_2012></a></h3>

	<ul>
		<li>Changed @region rule to ::region() functional pseudo-element</li>
		<li>Removed CSSRegionStyleRule (see above)</li>
		<li>Tied named flow event triggers to visual processing model</li>
		<li>Described how visual formatting of nested regions works</li>
		<li>Added content and element keywords to flow-into</li>
		<li>Added regionoversetchange event</li>
		<li>renamed regionlayoutupdate to regionfragmentchange</li>
		<li>Defined offsetParent interaction</li>
		<li>Removed implication of DOM manipulation</li>
		<li>Changed Appendix A to use custom element layout.</li>
		<li>Noted change in pseudo-element generation with flow-from.</li>
		<li>Changed case of regionlayoutupdate to match other events in <a data-biblio-type=informative data-link-type=biblio href=#biblio-dom-level-3-events title=DOM-LEVEL-3-EVENTS>[DOM-LEVEL-3-EVENTS]</a>.</li>
		<li>Added section on fragmenting the fragmenters.</li>
		<li>Added section on handling circular flow-from and flow-into situations.</li>
		<li>Added alignment and justification to region styling properties.</li>
		<li>Added timing for regionLayoutUpdate event.</li>
		<li>Clarified interaction between content and flow-from for pseudo-elements.</li>
		<li>Changed NamedFlowCollection getters to return undefined when there is no NamedFlow.</li>
		<li>Changed region-overflow property to region-fragment.</li>
	</ul>

<h3 class="heading settled" data-level=11.4 id=changes_from_May_03_2012><span class=secno>11.4. </span><span class=content>
Changes from <a href=http://www.w3.org/TR/2012/WD-css3-regions-20120503/>May 3<sup>rd</sup> 2012</a> version</span><a class=self-link href=#changes_from_May_03_2012></a></h3>

	<ul>
		<li>Removed exceptions from the Region interface.</li>
		<li>Changed NamedFlowCollection from live to a static snapshot.</li>
		<li>Changed NamedFlow to inherit from EventTarget.</li>
		<li>Removed flowFrom from Region interface and changed method name to getComputedRegionStyle().</li>
		<li>Region interface is now a supplemental interface with the [NoInterfaceObject] extended attribute.</li>
		<li>Added note for regionLayoutUpdate dispatching in nested flows.</li>
		<li>Removed Document.getFlowByName() in favor of NamedFlowCollection.namedItem().</li>
		<li>Changed to overset:false for NULL NamedFlow.</li>
		<li>Changed regionLayoutUpdate to not bubble.</li>
	</ul>

<h3 class="heading settled" data-level=11.5 id=older_changes><span class=secno>11.5. </span><span class=content>Older Changes</span><a class=self-link href=#older_changes></a></h3>

<p>Older changelogs are <a href=http://wiki.csswg.org/spec/css3-regions/older-changelogs>archived</a> on the CSSWG wiki.</p>

<h2 class="no-num heading settled" id=acknowledgments><span class=content>
Acknowledgments</span><a class=self-link href=#acknowledgments></a></h2>

<p>The editors are grateful to the CSS working group
	for their feedback and help with the genesis of this specification.</p>

<p>In addition, the editors would like to thank
	the following individuals for their contributions, 
	either during the conception of CSS Regions 
	or during its development and specification review process:</p>

<p>Erik Arvidsson,
	Tab Atkins, 
	Catalin Badea, 
	Mihai Balan, 
	Andrei Bucur, 
	Razvan Caliman, 
	Alexandru Chiculita, 
	Phil Cupp, 
	Arron Eicholz, 
	John Jansen, 
	CJ Gammon, 
	Dimitri Glazkov, 
	Daniel Glazman, 
	Arno Gourdol, 
	Catalin Grigoroscuta, 
	David Hyatt, 
	Brian Heuston, 
	Ian Hickson, 
	Jonathan Hoersch, 
	Michael Jolson, 
	Brad Kemper, 
	Håkon Wium Lie, 
	Kang-Hao (Kenny) Lu, 
	Mihai Maerean, 
	Markus Mielke, 
	Robert O’Callahan, 
	Edward O’Connor, 
	Mihnea Ovidenie, 
	Virgil Palanciuc, 
	Olga Popiv, 
	Christoph Päper, 
	Anton Prowse, 
	Peter Sorotokin, 
	Elliott Sprehn, 
	Radu Stavila, 
	Christian Stockwell, 
	Eugene Veselov, 
	Boris Zbarsky,	
	Stephen Zilles 
	and the CSS Working Group members.</p>

<h2 class="no-ref no-num heading settled" id=conformance><span class=content>
Conformance</span><a class=self-link href=#conformance></a></h2>

<h3 class="no-ref heading settled" id=conventions><span class=content>
Document conventions</span><a class=self-link href=#conventions></a></h3>

    <p>Conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words "MUST",
    "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
    "RECOMMENDED", "MAY", and "OPTIONAL" in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification.

    <p>All of the text of this specification is normative except sections
    explicitly marked as non-normative, examples, and notes. <a data-biblio-type=normative data-link-type=biblio href=#biblio-rfc2119 title=RFC2119>[RFC2119]</a></p>

    <p>Examples in this specification are introduced with the words "for example"
    or are set apart from the normative text with <code>class="example"</code>,
    like this:

    <div class=example>
        <p>This is an example of an informative example.</p>
    </div>

    <p>Informative notes begin with the word "Note" and are set apart from the
    normative text with <code>class="note"</code>, like this:

    <p class=note>Note, this is an informative note.</p>

    <p>Advisements are normative sections styled to evoke special attention and are
    set apart from other normative text with <code>&lt;strong class="advisement"&gt;</code>, like
    this:

    <strong class=advisement>
        UAs MUST provide an accessible alternative.
    </strong>

<h3 class="no-ref heading settled" id=conformance-classes><span class=content>
Conformance classes</span><a class=self-link href=#conformance-classes></a></h3>

    <p>Conformance to this specification
    is defined for three conformance classes:
    <dl>
        <dt>style sheet
            <dd>A <a href=http://www.w3.org/TR/CSS21/conform.html#style-sheet>CSS
            style sheet</a>.
        <dt>renderer
            <dd>A <a href=http://www.w3.org/TR/CSS21/conform.html#user-agent>UA</a>
            that interprets the semantics of a style sheet and renders
            documents that use them.
        <dt>authoring tool
            <dd>A <a href=http://www.w3.org/TR/CSS21/conform.html#user-agent>UA</a>
            that writes a style sheet.
    </dl>

    <p>A style sheet is conformant to this specification
    if all of its statements that use syntax defined in this module are valid
    according to the generic CSS grammar and the individual grammars of each
    feature defined in this module.

    <p>A renderer is conformant to this specification
    if, in addition to interpreting the style sheet as defined by the
    appropriate specifications, it supports all the features defined
    by this specification by parsing them correctly
    and rendering the document accordingly. However, the inability of a
    UA to correctly render a document due to limitations of the device
    does not make the UA non-conformant. (For example, a UA is not
    required to render color on a monochrome monitor.)

    <p>An authoring tool is conformant to this specification
    if it writes style sheets that are syntactically correct according to the
    generic CSS grammar and the individual grammars of each feature in
    this module, and meet all other conformance requirements of style sheets
    as described in this module.

<h3 class="no-ref heading settled" id=partial><span class=content>
Partial implementations</span><a class=self-link href=#partial></a></h3>

    <p>So that authors can exploit the forward-compatible parsing rules to
    assign fallback values, CSS renderers <strong>must</strong>
    treat as invalid (and <a href=http://www.w3.org/TR/CSS21/conform.html#ignore>ignore
    as appropriate</a>) any at-rules, properties, property values, keywords,
    and other syntactic constructs for which they have no usable level of
    support. In particular, user agents <strong>must not</strong> selectively
    ignore unsupported component values and honor supported values in a single
    multi-value property declaration: if any value is considered invalid
    (as unsupported values must be), CSS requires that the entire declaration
    be ignored.</p>

<h3 class="no-ref heading settled" id=experimental><span class=content>
Experimental implementations</span><a class=self-link href=#experimental></a></h3>

    <p>To avoid clashes with future CSS features, the CSS2.1 specification
    reserves a <a href=http://www.w3.org/TR/CSS21/syndata.html#vendor-keywords>prefixed
    syntax</a> for proprietary and experimental extensions to CSS.

    <p>Prior to a specification reaching the Candidate Recommendation stage
    in the W3C process, all implementations of a CSS feature are considered
    experimental. The CSS Working Group recommends that implementations
    use a vendor-prefixed syntax for such features, including those in
    W3C Working Drafts. This avoids incompatibilities with future changes
    in the draft.
    </p>

<h3 class="no-ref heading settled" id=testing><span class=content>
Non-experimental implementations</span><a class=self-link href=#testing></a></h3>

    <p>Once a specification reaches the Candidate Recommendation stage,
    non-experimental implementations are possible, and implementors should
    release an unprefixed implementation of any CR-level feature they
    can demonstrate to be correctly implemented according to spec.

    <p>To establish and maintain the interoperability of CSS across
    implementations, the CSS Working Group requests that non-experimental
    CSS renderers submit an implementation report (and, if necessary, the
    testcases used for that implementation report) to the W3C before
    releasing an unprefixed implementation of any CSS features. Testcases
    submitted to W3C are subject to review and correction by the CSS
    Working Group.

    <p>Further information on submitting testcases and implementation reports
    can be found from on the CSS Working Group’s website at
    <a href=http://www.w3.org/Style/CSS/Test/>http://www.w3.org/Style/CSS/Test/</a>.
    Questions should be directed to the
    <a href=http://lists.w3.org/Archives/Public/public-css-testsuite>public-css-testsuite@w3.org</a>
    mailing list.



<h2 class="no-num heading settled" id=references><span class=content>References</span><a class=self-link href=#references></a></h2><h3 class="no-num heading settled" id=normative><span class=content>Normative References</span><a class=self-link href=#normative></a></h3><dl><dt id=biblio-css21 title=CSS21><a class=self-link href=#biblio-css21></a>[CSS21]<dd>Bert Bos; et al. <a href=http://www.w3.org/TR/2011/REC-CSS2-20110607>Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification</a>. 7 June 2011. W3C Recommendation. URL: <a href=http://www.w3.org/TR/2011/REC-CSS2-20110607>http://www.w3.org/TR/2011/REC-CSS2-20110607</a><dt id=biblio-css3-writing-modes title=CSS3-WRITING-MODES><a class=self-link href=#biblio-css3-writing-modes></a>[CSS3-WRITING-MODES]<dd>Elika J. Etemad; Koji Ishii. <a href=http://www.w3.org/TR/2012/WD-css3-writing-modes-20121115/>CSS Writing Modes Module Level 3</a>. 15 November 2012. W3C Working Draft. (Work in progress.) URL: <a href=http://www.w3.org/TR/2012/WD-css3-writing-modes-20121115/>http://www.w3.org/TR/2012/WD-css3-writing-modes-20121115/</a><dt id=biblio-css3col title=CSS3COL><a class=self-link href=#biblio-css3col></a>[CSS3COL]<dd>Håkon Wium Lie. <a href=http://www.w3.org/TR/css3-multicol/>CSS3 module: Multi-column layout</a>. CR. URL: <a href=http://www.w3.org/TR/css3-multicol/>http://www.w3.org/TR/css3-multicol/</a><dt id=biblio-dom-level-3-events title=DOM-Level-3-Events><a class=self-link href=#biblio-dom-level-3-events></a>[DOM-Level-3-Events]<dd>Gary Kacmarcik; et al. <a href=http://www.w3.org/TR/DOM-Level-3-Events/>Document Object Model (DOM) Level 3 Events Specification</a>. WD. URL: <a href=http://www.w3.org/TR/DOM-Level-3-Events/>http://www.w3.org/TR/DOM-Level-3-Events/</a><dt id=biblio-select title=SELECT><a class=self-link href=#biblio-select></a>[SELECT]<dd>Tantek Çelik; et al. <a href=http://www.w3.org/TR/2011/REC-css3-selectors-20110929/>Selectors Level 3</a>. 29 September 2011. W3C Recommendation. URL: <a href=http://www.w3.org/TR/2011/REC-css3-selectors-20110929/>http://www.w3.org/TR/2011/REC-css3-selectors-20110929/</a><dt id=biblio-css3-break title=css3-break><a class=self-link href=#biblio-css3-break></a>[css3-break]<dd>Rossen Atanassov; Elika Etemad. <a href=http://www.w3.org/TR/css3-break/>CSS Fragmentation Module Level 3</a>. WD. URL: <a href=http://www.w3.org/TR/css3-break/>http://www.w3.org/TR/css3-break/</a><dt id=biblio-cssom title=cssom><a class=self-link href=#biblio-cssom></a>[cssom]<dd>Simon Pieters; Glenn Adams. <a href=http://www.w3.org/TR/cssom/>CSS Object Model (CSSOM)</a>. WD. URL: <a href=http://www.w3.org/TR/cssom/>http://www.w3.org/TR/cssom/</a><dt id=biblio-dom title=dom><a class=self-link href=#biblio-dom></a>[dom]<dd>Anne van Kesteren; et al. <a href=http://www.w3.org/TR/dom/>W3C DOM4</a>. LCWD. URL: <a href=http://www.w3.org/TR/dom/>http://www.w3.org/TR/dom/</a><dt id=biblio-rfc2119 title=rfc2119><a class=self-link href=#biblio-rfc2119></a>[rfc2119]<dd>S. Bradner. <a href=http://www.ietf.org/rfc/rfc2119.txt>Key words for use in RFCs to Indicate Requirement Levels</a>. Best Current Practice. URL: <a href=http://www.ietf.org/rfc/rfc2119.txt>http://www.ietf.org/rfc/rfc2119.txt</a></dl><h3 class="no-num heading settled" id=informative><span class=content>Informative References</span><a class=self-link href=#informative></a></h3><dl><dt id=biblio-css3-flexbox title=CSS3-FLEXBOX><a class=self-link href=#biblio-css3-flexbox></a>[CSS3-FLEXBOX]<dd>Tab Atkins Jr.; Elika J. Etemad; Alex Mogilevsky. <a href=http://www.w3.org/TR/2012/CR-css3-flexbox-20120918/>CSS Flexible Box Layout Module</a>. 18 September 2012. W3C Candidate Recommendation. (Work in progress.) URL: <a href=http://www.w3.org/TR/2012/CR-css3-flexbox-20120918/>http://www.w3.org/TR/2012/CR-css3-flexbox-20120918/</a><dt id=biblio-css3-line-grid title=CSS3-LINE-GRID><a class=self-link href=#biblio-css3-line-grid></a>[CSS3-LINE-GRID]<dd>Koji Ishii. <a href=http://dev.w3.org/csswg/css-line-grid/>CSS Line Grid Module</a>. Proposal for a CSS module. (Retrieved 26 October 2011) URL: <a href=http://dev.w3.org/csswg/css-line-grid/>http://dev.w3.org/csswg/css-line-grid/</a><dt id=biblio-css3-page-template title=CSS3-PAGE-TEMPLATE><a class=self-link href=#biblio-css3-page-template></a>[CSS3-PAGE-TEMPLATE]<dd>Alan Stearns. <a href=http://dev.w3.org/csswg/css3-page-template/>CSS Pagination Templates Module Level 3</a>. Proposal for a CSS module. (Retrieved 4 April 2012) URL: <a href=http://dev.w3.org/csswg/css3-page-template/>http://dev.w3.org/csswg/css3-page-template/</a><dt id=biblio-css3page title=CSS3PAGE><a class=self-link href=#biblio-css3page></a>[CSS3PAGE]<dd>Melinda Grant; et al. <a href=http://www.w3.org/TR/2013/WD-css3-page-20130314/>CSS Paged Media Module Level 3</a>. 14 March 2013. W3C Working Draft. (Work in progress.) URL: <a href=http://www.w3.org/TR/2013/WD-css3-page-20130314/>http://www.w3.org/TR/2013/WD-css3-page-20130314/</a><dt id=biblio-css3ui title=CSS3UI><a class=self-link href=#biblio-css3ui></a>[CSS3UI]<dd>Tantek Çelik. <a href=http://www.w3.org/TR/css3-ui/>CSS3 Basic User Interface Module</a>. WD. URL: <a href=http://www.w3.org/TR/css3-ui/>http://www.w3.org/TR/css3-ui/</a><dt id=biblio-css3-exclusions title=css3-exclusions><a class=self-link href=#biblio-css3-exclusions></a>[css3-exclusions]<dd>Vincent Hardy; Rossen Atanassov; Alan Stearns. <a href=http://www.w3.org/TR/css3-exclusions/>CSS Exclusions Module Level 1</a>. WD. URL: <a href=http://www.w3.org/TR/css3-exclusions/>http://www.w3.org/TR/css3-exclusions/</a><dt id=biblio-cssom-view title=cssom-view><a class=self-link href=#biblio-cssom-view></a>[cssom-view]<dd>Simon Pieters; Glenn Adams. <a href=http://www.w3.org/TR/cssom-view/>CSSOM View Module</a>. WD. URL: <a href=http://www.w3.org/TR/cssom-view/>http://www.w3.org/TR/cssom-view/</a><dt id=biblio-html40 title=html40><a class=self-link href=#biblio-html40></a>[html40]<dd>Dave Raggett; Arnaud Le Hors; Ian Jacobs. <a href=http://www.w3.org/TR/html40>HTML 4.0 Recommendation</a>. REC. URL: <a href=http://www.w3.org/TR/html40>http://www.w3.org/TR/html40</a></dl><h2 class="no-num heading settled" id=index><span class=content>Index</span><a class=self-link href=#index></a></h2><ul class=indexlist><li>break-after, <a href=#propdef-break-after title="section 3.3">3.3</a><li>break-before, <a href=#propdef-break-before title="section 3.3">3.3</a><li>break-inside, <a href=#propdef-break-inside title="section 3.3">3.3</a><li>content, <a href=#content title="section 3.1">3.1</a><li>CSS Region, <a href=#css-region title="section 2.1">2.1</a><li>delete(), <a href=#dom-namedflowmap-delete title="section 4.1">4.1</a><li>element, <a href=#element title="section 3.1">3.1</a><li>firstEmptyRegionIndex, <a href=#dom-namedflow-firstemptyregionindex title="section 4.1">4.1</a><li>flow fragment height, <a href=#flow-fragment-height title="section 7.3">7.3</a><li>flow-from, <a href=#propdef-flow-from title="section 3.2">3.2</a><li>flow-into, <a href=#propdef-flow-into title="section 3.1">3.1</a><li>flowName<ul><li>argument for NamedFlowMap/get(), <a href=#dom-namedflowmap-get-flowname title="section 4.1">4.1</a><li>argument for NamedFlowMap/has(), <a href=#dom-namedflowmap-has-flowname title="section 4.1">4.1</a><li>argument for NamedFlowMap/set(), <a href=#dom-namedflowmap-set-flowname title="section 4.1">4.1</a><li>argument for NamedFlowMap/delete(), <a href=#dom-namedflowmap-delete-flowname title="section 4.1">4.1</a></ul><li>flowValue, <a href=#dom-namedflowmap-set-flowvalue title="section 4.1">4.1</a><li>get(), <a href=#dom-namedflowmap-get title="section 4.1">4.1</a><li>getContent(), <a href=#dom-namedflow-getcontent title="section 4.1">4.1</a><li>getRegionFlowRanges(), <a href=#dom-region-getregionflowranges title="section 4.2">4.2</a><li>getRegions(), <a href=#dom-namedflow-getregions title="section 4.1">4.1</a><li>getRegionsByContent(), <a href=#dom-namedflow-getregionsbycontent title="section 4.1">4.1</a><li>has(), <a href=#dom-namedflowmap-has title="section 4.1">4.1</a><li>name, <a href=#dom-namedflow-name title="section 4.1">4.1</a><li>named flow, <a href=#named-flow title="section 2.3">2.3</a><li>NamedFlow, <a href=#dom-namedflow title="section 4.1">4.1</a><li>NamedFlowMap, <a href=#dom-namedflowmap title="section 4.1">4.1</a><li>namedFlows<ul><li>definition of, <a href=#document-namedflows title="section 4.1">4.1</a><li>attribute for Document, <a href=#dom-document-namedflows title="section 4.1">4.1</a></ul><li>nested region context, <a href=#nested-region-context title="section 3.2.2">3.2.2</a><li>node, <a href=#dom-namedflow-getregionsbycontent-node title="section 4.1">4.1</a><li>overset, <a href=#dom-namedflow-overset title="section 4.1">4.1</a><li>Region, <a href=#dom-region title="section 4.2">4.2</a><li>region chain, <a href=#region-chain title="section 2.2">2.2</a><li>region flow content box, <a href=#region-flow-content-box title="section 7.2">7.2</a><li>region-fragment, <a href=#propdef-region-fragment title="section 3.4">3.4</a><li>regionOverset, <a href=#dom-region-regionoverset title="section 4.2">4.2</a><li>RFCB, <a href=#rfcb title="section 7.2">7.2</a><li>set(), <a href=#dom-namedflowmap-set title="section 4.1">4.1</a><li>specified flow, <a href=#specified-flow title="section 3.1">3.1</a></ul><h2 class="no-num heading settled" id=property-index><span class=content>Property Index</span><a class=self-link href=#property-index></a></h2><table class="proptable data"><thead><tr><th scope=col>Name<th scope=col>Value<th scope=col>Initial<th scope=col>Applies to<th scope=col>Inh.<th scope=col>%ages<th scope=col>Media<th scope=col>Computed value<tbody><tr><th scope=row><a class=css data-link-type=property href=#propdef-flow-into title=flow-into>flow-into</a><td>none | &lt;ident&gt; [element|content]?<td>none<td>All elements, but not pseudo-elements such as ::first-line, ::first-letter, ::before or ::after.<td>no<td><td>visual<td>as specified<tr><th scope=row><a class=css data-link-type=property href=#propdef-flow-from title=flow-from>flow-from</a><td>&lt;ident&gt; | none | inherit<td>none<td>Non-replaced block containers.  This might be expanded in future versions of the specification to allow other types of containers to receive flow content.<td>no<td><td>visual<td>as specified<tr><th scope=row><a class=css data-link-type=property href=#propdef-break-before title=break-before>break-before</a><td>auto | always | avoid | left | right | page | column | region | avoid-page | avoid-column | avoid-region<td>auto<td>block-level elements<td>no<td><td>visual<td>as specified<tr><th scope=row><a class=css data-link-type=property href=#propdef-break-after title=break-after>break-after</a><td>auto | always | avoid | left | right | page | column | region | avoid-page | avoid-column | avoid-region<td>auto<td>block-level elements<td>no<td><td>visual<td>as specified<tr><th scope=row><a class=css data-link-type=property href=#propdef-break-inside title=break-inside>break-inside</a><td>auto | avoid | avoid-page | avoid-column | avoid-region<td>auto<td>block-level elements<td>no<td><td>visual<td>as specified<tr><th scope=row><a class=css data-link-type=property href=#propdef-region-fragment title=region-fragment>region-fragment</a><td>auto | break<td>auto<td>CSS Regions<td>no<td><td>visual<td>as specified</table>